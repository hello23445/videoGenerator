<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Generator</title>
    <!-- Add Font Awesome CDN for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <!-- Google Fonts for modern look -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        html, body {
            overscroll-behavior-y: contain;
        }
        html {
            scroll-behavior: smooth;  
        }  
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', sans-serif;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
            background: linear-gradient(135deg, #001f5f, #001255); /* Slightly bluer dark blue gradient */
            color: #ffffff;
        }

        .container {
            display: flex;
            gap: 40px;
            max-width: 1200px;
            width: 100%;
            flex-wrap: wrap;
            justify-content: center;
            background: rgba(255, 255, 255, 0.05); /* Subtle overlay for modern feel */
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }

        .left-section, .right-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
            max-width: 400px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        label {
            font-weight: 500;
            color: #e0e0e0;
        }

        input, select, textarea {
            padding: 12px;
            border: 2px solid #333;
            border-radius: 10px;
            font-size: 16px;
            background: #0a2a4a;
            color: #ffffff;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        input:focus, select:focus, textarea:focus {
            border-color: #4a90e2;
            box-shadow: 0 0 8px rgba(74, 144, 226, 0.5);
            outline: none;
        }

        input.error, select.error, textarea.error {
            border-color: #ff4d4d;
        }

        button {
            padding: 12px;
            background-color: #4a90e2;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: background-color 0.3s, transform 0.2s, box-shadow 0.3s;
        }

        button:hover {
            background-color: #357abd;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(53, 122, 189, 0.5);
        }

        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
            overflow-y: auto;
        }

        .modal-content {
            background-color: #0a2a4a;
            padding: 30px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s ease-in-out;
            max-height: 90vh;
            overflow-y: auto;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 10px;
            margin-bottom: 20px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background-color: #001f3f;
            border-radius: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            transition: transform 0.2s, background-color 0.3s;
            cursor: pointer;
        }

        .radio-option:hover {
            transform: translateY(-2px);
            background-color: #003366;
        }

        .radio-option input[type="radio"] {
            margin: 0;
            width: 20px;
            height: 20px;
        }

        .radio-option label {
            margin: 0;
            flex-grow: 1;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .radio-option label .icon-end {
            margin-left: auto;
        }

        .error-message, .success-message {
            margin-bottom: 20px;
        }

        .warning {
            color: #ff4d4d;
            font-weight: 500;
            margin-top: 10px;
        }

        .disabled-label {
            color: #777;
        }

        #noAttemptsMessage {
            color: #ff4d4d;
            font-weight: 500;
            text-align: center;
            margin-bottom: 10px;
        }

        #noAttemptsModal .modal-content, #noAttemptsMessage .input-group {
            background: #001f3f;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        #noAttemptsModal h2, #noAttemptsMessage h2 {
            color: #ffffff;
            font-size: 24px;
            margin-bottom: 15px;
        }

        #noAttemptsModal p, #noAttemptsMessage p {
            color: #e0e0e0;
            font-size: 16px;
            margin-bottom: 20px;
        }

        #noAttemptsModal .input-group, #noAttemptsMessage .input-group {
            margin-bottom: 20px;
            position: relative;
        }

        #noAttemptsModal input, #noAttemptsMessage input {
            padding: 12px;
            border: 2px solid #4a90e2;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        #noAttemptsModal input:focus, #noAttemptsMessage input:focus {
            border-color: #357abd;
            box-shadow: 0 0 8px rgba(53, 122, 189, 0.3);
        }

        #noAttemptsModal button, #noAttemptsMessage button {
            padding: 12px 25px;
            background: linear-gradient(90deg, #4a90e2, #357abd);
            border-radius: 8px;
            font-size: 16px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .remember-me-group {
            margin-top: 10px;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                align-items: center;
            }

            .left-section, .right-section {
                max-width: 100%;
            }
        }
        .a1:hover {
            color: #4a90e2;
            text-decoration: underline;
        }
        .a1{
            color: #357abd;
        }
        optgroup{
            font-weight: normal;
        }
        #preloader {
            display: none;
            text-align: center;
            margin-top: 20px;
            font-size: 18px;
            color: #e0e0e0;
        }
        .preview video {
            width: 100px;
            height: auto;
            border-radius: 10px;
        }
        #requestScreen {
            display: none;
            color: white;
            text-align: center;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }
        #requestDetails {
            margin-bottom: 20px;
            text-align: left;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            white-space: pre-wrap;
            font-size: 14px;
        }
        #userToken {
            margin-bottom: 20px;
        }
        #tokenButton {
            background-color: #4a90e2;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        #imagePreloader {
            font-size: 18px;
            margin-bottom: 20px;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        #generatedImage {
            max-width: 100%;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        #shareButtons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        #backToMenu {
            display: none;
        }
        @media (max-width: 768px) {
            #requestScreen {
                padding: 10px;
            }
            #requestDetails {
                font-size: 12px;
            }
        }
        .preloader-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }
        .preloader-text {
            font-size: 18px;
            font-weight: 500;
            color: #e0e0e0;
            text-shadow: 0 1px 3px rgba(0,0,0,0.2);
            margin-top: 10px;
        }
        .preloader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #4a90e2;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 0.8s linear infinite;
            box-shadow: 0 0 10px rgba(74, 144, 226, 0.5);
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Additional mobile optimizations */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .modal-content {
                width: 95%;
                padding: 15px;
            }
            button {
                font-size: 14px;
                padding: 10px;
            }
            input, select, textarea {
                font-size: 14px;
            }
            .radio-group {
                gap: 10px;
            }
            .radio-option {
                padding: 10px;
            }
        }
        .toggle-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .toggle-group label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
            justify-content: space-between;
            width: 100%;
        }

        /* Toggle Switch CSS */
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .switch input { 
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #2196F3;
        }

        input:focus + .slider {
            box-shadow: 0 0 1px #2196F3;
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .disabled-label .switch .slider {
            background-color: #777;
            cursor: not-allowed;
        }
        .label-text {
            flex-grow: 1;
            white-space: normal;
            overflow: visible;
            text-overflow: clip;
        }
        /* === ГРУППА ПЕРЕКЛЮЧАТЕЛЕЙ === */
        .toggle-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
            width: 100%;
        }

        .toggle-group label {
            display: flex;
            align-items: center; /* выравнивание по вертикали */
            justify-content: space-between;
            gap: 10px;
            width: 100%;
            max-width: 320px; /* фикс для одинаковых строк */
            line-height: 1.2;
        }

        /* === ПЕРЕКЛЮЧАТЕЛЬ === */
        .switch {
            position: relative;
            flex-shrink: 0; /* запрет на сжатие */
            display: inline-block;
            width: 60px;
            height: 34px;
            vertical-align: middle; /* не даём падать вниз */
        }

        .switch input { 
            opacity: 0;
            width: 0;
            height: 0;
        }

        /* === СЛАЙДЕР === */
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
            width: 60px;
            height: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #2196F3;
        }
        input:focus + .slider {
            box-shadow: 0 0 1px #2196F3;
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* === СПАН И ТЕКСТ === */
        .label-text, .toggle-group span {
            flex-grow: 1;
            white-space: nowrap; /* чтобы не ломался текст */
            overflow: hidden;
            text-overflow: ellipsis;
            vertical-align: middle; /* ровное выравнивание */
            display: inline-block;
            line-height: normal;
        }

        /* Единая ширина для всех переключателей */
        .switch, .slider {
            min-width: 60px !important;
            max-width: 60px !important;
        }

    </style>
</head>
<body>
    <div id="mainContainer" class="container" style="display: none;">
        <div class="left-section">
            <div class="input-group">
                <label for="quality">Качество видео</label>
                <select id="quality">
                    <option value="described_in_desc">Указано в описании</option>
                    <option value="none" selected disabled>Выберите качество видео</option>
                    <option value="144p">144p</option>
                    <option value="240p">240p</option>
                    <option value="360p">360p</option>
                    <option value="480p">480p</option>
                    <option value="720p60">720p60</option>
                    <option value="1080p60">1080p60 (HD)</option>
                    <option value="1440p60">1440p60 (HD)</option>
                    <option value="2160p60" disabled>(Premium)2160p60 (4K)</option>
                    <option value="4320p" disabled>(Premium)4320p (8K)</option>
                </select>
            </div>
            <div class="input-group">
                <label for="duration">Длительность видео</label>
                <select id="duration">
                    <option value="described_in_desc">Указано в описании</option>
                    <option value="none" selected disabled>Выберите длительность</option>
                    <option value="2s">2 секунды</option>
                    <option value="5s">5 секунд</option>
                    <option value="10s">10 секунд</option>
                    <option value="15s">15 секунд</option>
                    <option value="30s">30 секунд</option>
                    <option value="40s" disabled>(Premium)40 секунд</option>
                    <option value="50s" disabled>(Premium)50 секунд</option>
                    <option value="1min" disabled>(Premium)1 минута</option>
                    <option value="1min30s" disabled>(Premium)1 минута 30 секунд</option>
                    <option value="2min" disabled>(Premium)2 минуты</option>
                </select>
            </div>
            <div class="input-group">
                <label for="size">Размер видео (в пикселях)</label>
                <input type="text" id="sizeInput" placeholder="Buy Premium to type here" disabled>
                <select id="sizeSelect">
                    <option value="described_in_desc">Указано в описании</option>
                    <option value="">Выберите размер</option>
                    <option value="640x480">640x480</option>
                    <option value="1280x720">1280x720</option>
                    <option value="1600x900">1600x900</option>
                    <option value="1920x1080" selected>1920x1080</option>
                    <option value="2048x1152">2048x1152</option>
                    <option value="2560x1080">2560x1080</option>
                    <option value="320x240">320x240</option>
                    <option value="800x600">800x600</option>
                    <option value="1024x768">1024x768</option>
                    <option value="1280x1024">1280x1024</option>
                    <option value="1680x1050">1680x1050</option>
                    <option value="1920x1200">1920x1200</option>
                    <option value="2560x1600">2560x1600</option>
                    <option value="3440x1440">3440x1440</option>
                    <option value="3840x1600">3840x1600</option>
                    <option value="5120x1440">5120x1440</option>
                    <option value="2560x1440" disabled>(Premium)2560x1440</option>
                    <option value="3840x2160" disabled>(Premium)3840x2160</option>
                    <option value="4096x2160" disabled>(Premium)4096x2160 (DCI 4K)</option>
                    <option value="5120x2880" disabled>(Premium)5120x2880 (5K)</option>
                    <option value="7680x4320" disabled>(Premium)7680x4320 (8K UHD)</option>
                    <option value="10240x4320" disabled>(Premium)10240x4320 (10K)</option>
                    <option value="15360x8640" disabled>(Premium)15360x8640 (16K)</option>
                    <option value="1200x1200" disabled>(Premium)1200x1200 (Square)</option>
                    <option value="2048x2048" disabled>(Premium)2048x2048 (Square)</option>
                    <option value="4096x4096" disabled>(Premium)4096x4096 (Square)</option>
                    <option value="8192x8192" disabled>(Premium)8192x8192 (Square)</option>
                    <option value="11520x6480" disabled>(Premium)11520x6480 (12K)</option>
                    <option value="14400x8100" disabled>(Premium)14400x8100 (14K)</option>
                    <option value="17280x9720" disabled>(Premium)17280x9720 (17K)</option>
                    <option value="20480x11520" disabled>(Premium)20480x11520 (20K)</option>
                    <option value="23040x12960" disabled>(Premium)23040x12960 (23K)</option>
                </select>
            </div>
            <div class="input-group">
                <label for="style">Стиль видео</label>
                <select id="style">
                    <option value="described_in_desc">Указано в описании</option>
                    <option value="none" selected>Без стиля</option>
                    <option value="realistic">Реалистичный</option>
                    <option value="cartoon">Мультяшный</option>
                    <option value="watercolor">Акварель</option>
                    <option value="oil-painting">Масляная живопись</option>
                    <option value="sketch">Эскиз</option>
                    <option value="cyberpunk">Киберпанк</option>
                    <option value="retro">Ретро</option>
                    <option value="minimalist">Минимализм</option>
                    <option value="surreal">Сюрреализм</option>
                    <option value="pop-art">Поп-арт</option>
                    <option value="vintage">Винтаж</option>
                    <option value="fantasy">Фэнтези</option>
                    <option value="gothic">Готический</option>
                    <option value="HDR">HDR</option>
                    <option value="realism">Реализм</option>
                    <option value="3d-model">3D модель</option>
                    <option value="photographic">Фотографический</option>
                    <option value="line-art">Линейный арт</option>
                    <option value="tile-texture">Текстура тайла</option>
                    <option value="pixel">Пиксель</option>
                    <option value="illustration">Иллюстрация</option>
                    <option value="cinematic">Кинематографический</option>
                    <option value="comic-book">Комикс</option>
                    <option value="hyperrealistic">Гиперреалистичный</option>
                    <option value="dystopian">Дистопический</option>
                    <option value="ethereal">Эфирный</option>
                    <option value="steampunk" disabled>(Premium)Стимпанк</option>
                    <option value="abstract" disabled>(Premium)Абстрактный</option>
                    <option value="baroque" disabled>(Premium)Барокко</option>
                    <option value="futuristic" disabled>(Premium)Футуристический</option>
                    <option value="pixel-art" disabled>(Premium)Пиксель-арт</option>
                    <option value="impressionism" disabled>(Premium)Импрессионизм</option>
                    <option value="pointillism" disabled>(Premium)Пуантилизм</option>
                    <option value="cubism" disabled>(Premium)Кубизм</option>
                    <option value="expressionism" disabled>(Premium)Экспрессионизм</option>
                    <!-- Новые премиум стили -->
                    <option value="low-poly" disabled>(Premium)Low Poly</option>
                    <option value="line-art" disabled>(Premium)Линейный арт</option>
                    <option value="noir" disabled>(Premium)Нуар</option>
                    <option value="doodle" disabled>(Premium)Дудл</option>
                    <option value="mosaic" disabled>(Premium)Мозаика</option>
                    <option value="psychedelic" disabled>(Premium)Психоделика</option>
                    <option value="glitch" disabled>(Premium)Глитч</option>
                    <option value="vaporwave" disabled>(Premium)Vaporwave</option>
                    <option value="comic" disabled>(Premium)Комикс</option>
                    <option value="graffiti" disabled>(Premium)Граффити</option>
                    <option value="chibi" disabled>(Premium)Чиби</option>
                    <option value="dark-fantasy" disabled>(Premium)Тёмное фэнтези</option>
                    <option value="synthwave" disabled>(Premium)Synthwave</option>
                    <option value="flat" disabled>(Premium)Flat</option>
                    <option value="paper-cut" disabled>(Premium)Paper Cut</option>
                    <option value="digital-art" disabled>(Premium)Цифровое искусство</option>
                    <option value="origami" disabled>(Premium) Оригами</option>
                    <option value="neon" disabled>(Premium) Неон</option>
                    <option value="fantastic-realism" disabled>(Premium) Фантастический реализм</option>
                    <option value="bio-mechanic" disabled>(Premium) Биомеханика</option>
                    <option value="medieval" disabled>(Premium) Средневековый</option>
                    <option value="renaissance" disabled>(Premium) Ренессанс</option>
                    <option value="ukiyo-e" disabled>(Premium) Укиё-э</option>
                    <option value="low-light" disabled>(Premium) Низкая освещенность</option>
                    <option value="dreamcore" disabled>(Premium) Dreamcore</option>
                    <option value="gouache" disabled>(Premium) Гуашь</option>
                    <option value="charcoal" disabled>(Premium) Угольный рисунок</option>
                    <option value="isometric" disabled>(Premium) Изометрия</option>
                    <option value="luxury" disabled>(Premium) Люксовый стиль</option>
                    <option value="tribal" disabled>(Premium) Трайбл</option>
                    <option value="space-art" disabled>(Premium) Космический стиль</option>
                    <option value="holographic" disabled>(Premium) Голографический</option>
                    <option value="ornamental" disabled>(Premium) Орнаментальный</option>
                    <option value="mythology" disabled>(Premium) Мифология</option>
                    <option value="cybernetic" disabled>(Premium) Кибернетический</option>
                    <option value="steampunk-neo" disabled>(Premium) Нео-стимпанк</option>
                    <option value="surreal-dream" disabled>(Premium) Сюрреалистический сон</option>
                    <option value="victorian" disabled>(Premium) Викторианский</option>
                    <option value="art-nouveau" disabled>(Premium) Арт-нуво</option>
                    <option value="bauhaus" disabled>(Premium) Баухаус</option>
                    <option value="constructivism" disabled>(Premium) Конструктивизм</option>
                    <option value="dadaism" disabled>(Premium) Дадаизм</option>
                    <option value="fauvism" disabled>(Premium) Фовизм</option>
                    <option value="minimalist-modern" disabled>(Premium) Современный минимализм</option>

                </select>
            </div>
            <div class="input-group">
                <label for="color-tone">Тон цвета видео</label>
                <select id="color-tone">
                    <option value="described_in_desc">Указано в описании</option>
                    <option value="natural">Натуральный</option>
                    <option value="warm">Теплый</option>
                    <option value="cool">Холодный</option>
                    <option value="monochrome">Монохромный</option>
                    <option value="vibrant">Яркий</option>
                    <option value="cinematic">Кинематографический</option>
                    <option value="duotone">Дуотон</option>
                    <option value="analog">Аналоговый</option>
                    <option value="cross-process">Кросс-процесс</option>
                    <option value="pastel" disabled>(Premium)Пастельный</option>
                    <option value="sepia" disabled>(Premium)Сепия</option>
                    <!-- Новые премиум тоны -->
                    <option value="neon" disabled>(Premium)Неоновый</option>
                    <option value="matte" disabled>(Premium)Матовый</option>
                    <option value="metallic" disabled>(Premium)Металлик</option>
                    <option value="gradient" disabled>(Premium)Градиентный</option>
                    <option value="gold" disabled>(Premium)Золотой</option>
                    <option value="silver" disabled>(Premium)Серебряный</option>
                    <option value="pearl" disabled>(Premium)Перламутровый</option>
                    <option value="dark" disabled>(Premium)Тёмный</option>
                    <option value="light" disabled>(Premium)Светлый</option>
                </select>
            </div>
            <div class="input-group">
                <label for="detail-level">Уровень детализации видео</label>
                <select id="detail-level">
                    <option value="described_in_desc">Указано в описании</option>
                    <option value="Низкий">Низкий</option>
                    <option value="weak">Слабый</option>
                    <option value="normal" selected>Нормальный</option>
                    <option value="high" disabled>(Premium)Высокий</option>
                    <option value="ultra" disabled>(Premium)Ультра</option>
                </select>
            </div>
            <div class="input-group">
                <label for="selector" style="margin-bottom: 0%;">Выберите ИИ, который будет генерировать для вас видео</label>
                <select id="selector" style="margin-top: 0%; width: 100%;">
                <option value="described_in_desc">Указано в описании</option>
                <optgroup label="Собственный">
                    <option value="custom" selected>Собственный</option>
                </optgroup>
                <optgroup label="Другие">
                    <option value="runway">Runway Gen-3 Alpha</option>
                    <option value="pika">Pika Labs</option>
                    <option value="kaiber">Kaiber</option>
                    <option value="haiper">Haiper AI</option>
                    <option value="stability">Stable Video Diffusion (Stability AI)</option>
                    <option value="pixverse">PixVerse AI</option>
                    <option value="viggle">Viggle AI</option>
                    <option value="genmo">Genmo AI</option>
                    <option value="colossyan">Colossyan Creator</option>
                    <option value="synthesia">Synthesia</option>
                    <option value="promeai">PromeAI</option>
                    <option value="sora2">Sora 2</option>
                    <option value="klingai">Kling AI</option>
                    <option value="hailuoai">Hailuo AI</option>
                    <option value="mochi1">Mochi 1</option>
                    <option value="hunyuanvideo">Hunyuan Video</option>
                    <option value="veo31">Veo 3.1</option>
                    <option value="lumadreammachine">Luma AI Dream Machine</option>
                    <option value="neuralframes">Neural Frames</option>
                    <option value="komikoai">KomikoAI</option>
                    <option value="lumen5"disabled>(Premium)Lumen5</option>
                    <option value="deepbrain"disabled>(Premium)DeepBrain AI</option>
                    <option value="hourone"disabled>(Premium)Hour One</option>
                    <option value="heygen"disabled>(Premium)HeyGen</option>
                    <option value="kipu" disabled>(Premium)Kipu AI</option>
                    <option value="movio" disabled>(Premium)Movio</option>
                    <option value="artflow" disabled>(Premium)Artflow AI</option>
                    <option value="elai" disabled>(Premium)Elai.io</option>
                    <option value="veo" disabled>(Premium)Google Veo</option>
                    <option value="synthesys" disabled>(Premium)Synthesys Studio</option>
                    <option value="sora"disabled>(Premium)OpenAI Sora</option>
                </optgroup>
                </select>

                <div>
                <label for="photo_theme" style="margin-bottom: 0%;">Выберите фон видео</label><br>
                <select id="photo_theme" style="margin-top: 0%; width: 100%;">
                    <option value="described_in_desc">Указано в описании</option>
                    <!-- Бесплатные -->
                    <option value="Автоматический выбор фона" selected>Автоматический выбор фона</option>
                    <option value="Прозрачный">Прозрачный</option>
                    <option value="Разноцветный">Разноцветный</option>
                    <option value="Темный">Темный</option>
                    <option value="Заливка цветом">Заливка цветом</option>
                    <option value="Статуя свободы">Статуя свободы</option>
                    <option value="Горы">Горы</option>
                    <option value="Пляж">Пляж</option>
                    <option value="Космос">Космос</option>
                    <option value="Закат">Закат</option>
                    <option value="Лес">Лес</option>
                    <option value="Озеро">Озеро</option>
                    <option value="Снег">Снег</option>
                    <option value="Пустыня">Пустыня</option>
                    <option value="Футбольное поле">Футбольное поле</option>
                    <option value="Абстракция">Абстракция</option>
                    <option value="Акварель">Акварель</option>
                    <option value="Мозаика">Мозаика</option>
                    <option value="Ретро">Ретро</option>
                    <option value="Минимализм">Минимализм</option>
                    <option value="Киберпанк">Киберпанк</option>
                    <option value="Эйфелева башня">Эйфелева башня</option>
                    <option value="Случайный фон">Случайный фон</option>
                    <option value="Фон с случайным городом">Фон с случайным городом</option>
                    <option value="Северное сияние">Северное сияние</option>
                    <option value="Городской пейзаж">Городской пейзаж</option>
                    <option value="Ночной город">Ночной город</option>
                    <option value="Летний сад">Летний сад</option>
                    <option value="Осенний лес">Осенний лес</option>
                    <option value="Зимний пейзаж">Зимний пейзаж</option>
                    <option value="Весенние цветы">Весенние цветы</option>
                    <option value="Океанский вид">Океанский вид</option>
                    <option value="Горный хребет">Горный хребет</option>
                    <option value="Пустынные дюны">Пустынные дюны</option>
                    <option value="Лунный свет">Лунный свет</option>
                    <option value="Звездное небо">Звездное небо</option>
                    <option value="Речной берег">Речной берег</option>
                    <option value="Лесная тропа">Лесная тропа</option>
                    <option value="Поле цветов">Поле цветов</option>
                    <option value="Futuristic City">Futuristic City</option>
                    <option value="Enchanted Forest">Enchanted Forest</option>
                    <option value="Abstract Geometric">Abstract Geometric</option>
                    <option value="Underwater Scene">Underwater Scene</option>
                    <option value="Space Nebula">Space Nebula</option>
                    <option value="Mountain Landscape">Mountain Landscape</option>
                    <option value="Urban Street">Urban Street</option>
                    <option value="Desert Dunes">Desert Dunes</option>
                    <option value="Forest Path">Forest Path</option>
                    <option value="Ocean Waves">Ocean Waves</option>

                    <!-- Премиум -->
                    <option value="Город" disabled>(Premium) Город</option>
                    <option value="Градиент" disabled>(Premium) Градиент</option>
                    <option value="Тадж-Махал" disabled>(Premium) Тадж-Махал</option>
                    <option value="Колизей" disabled>(Premium) Колизей</option>
                    <option value="Великая китайская стена" disabled>(Premium) Великая китайская стена</option>
                    <option value="Огни мегаполиса" disabled>(Premium) Огни мегаполиса</option>
                    <option value="Фантастический мир" disabled>(Premium) Фантастический мир</option>
                    <option value="Неон" disabled>(Premium) Неон</option>
                    <option value="Океанские глубины" disabled>(Premium) Океанские глубины</option>
                    <option value="Пещера кристаллов" disabled>(Premium) Пещера кристаллов</option>
                    <option value="Галактика" disabled>(Premium) Галактика</option>
                    <option value="Замок (устройство)" disabled>(Premium) 🔒 Замок (устройство для запирания)</option>
                    <option value="Замок (здание)" disabled>(Premium) 🏰 Замок (здание)</option>
                    <option value="Футуризм" disabled>(Premium) Футуризм</option>
                    <option value="Райский остров" disabled>(Premium) Райский остров</option>
                    <option value="Подводный город" disabled>(Premium) Подводный город</option>
                    <option value="Космическая станция" disabled>(Premium) Космическая станция</option>
                    <option value="Древний храм" disabled>(Premium) Древний храм</option>
                    <option value="Волшебный лес" disabled>(Premium) Волшебный лес</option>
                    <option value="Неоновый мегаполис" disabled>(Premium) Неоновый мегаполис</option>
                </select>

                    <label for="razmitiyPHON" style="user-select: none;" accesskey="z">
                        <input type="checkbox" id="razmitiyPHON">
                        [Z] Размытие фона
                    </label>
                </div>
                <div style="margin-top: 4%;">
                    <label for="fileInput" id="fileInputTextLabel">Вы можете загрузить видео для примера и так далее...</label><br>
                    <input type="file" id="fileInput" multiple accept="video/*">
                    <button id="uploadButton" accesskey="u" onclick="uploadPhotos()">[U] Загрузить</button>
                </div>
                <div id="previews"></div>
                <div id="preloader">Загрузка...</div>
                <div id="result"></div>
                
                
            </div>
        </div>
        <div class="right-section">
            <div>
                <label for="soot">Соотношение сторон</label>
                <select id="soot" style="margin-top:1%;width: 100%;">
                    <option value="described_in_desc">Указано в описании</option>
                    <option value="1:1">1:1 (Квадрат)</option>
                    <option value="3:2">3:2 (Классика фото)</option>
                    <option value="4:3" disabled>(Premium) 4:3 (Фотоаппарат)</option>
                    <option value="5:4">5:4 (Полароид)</option>
                    <option value="9:16" selected>9:16 (Вертикаль / Сторис)</option>
                    <option value="16:9" disabled>(Premium) 16:9 (Горизонталь / Видео)</option>
                    <option value="2:3">2:3 (Портрет)</option>
                    <option value="4:5">4:5 (Instagram-пост)</option>
                    <option value="21:9" disabled>(Premium) 21:9 (Панорама / Кино)</option>
                    <option value="32:9" disabled>(Premium) 32:9 (Ультраширокая панорама)</option>
                    <option value="9:4">9:4 (Баннер / Обложка)</option>
                    <option value="27:40">27:40 (Постер / Афиша)</option>
                </select>

            </div>
            <div>
                <label for="ram">Выберите рамку для видео</label>
                <select id="ram" style="margin-top:1%;width:100%;">
                    <option value="described_in_desc">Указано в описании</option>
                    <optgroup label="🔹 Простые рамки">
                        <option value="none" selected>Без рамки</option>
                        <option value="simple">Обычная</option>
                        <option value="rounded">Скруглённая</option>
                        <option value="thick">Толстая</option>
                        <option value="shadow">Тонкая с тенью</option>
                        <option value="dotted">Пунктирная</option>
                        <option value="dashed">Штриховая</option>
                        <option value="double">Двойная</option>
                        <option value="groove">Вдавленная</option>
                        <option value="ridge">Выпуклая</option>
                        <option value="inset">Внутренняя</option>
                        <option value="outset">Внешняя</option>
                        <option value="solid-thin">Тонкая сплошная</option>
                        <option value="solid-medium">Средняя сплошная</option>
                    </optgroup>

                    <optgroup label="🎨 Художественные рамки">
                        <option value="gradient">Градиентная</option>
                        <option value="neon">Неоновая</option>
                        <option value="metallic" disabled>(Premium) Металлическая</option>
                        <option value="watercolor">Акварельная</option>
                        <option value="vintage">Ретро / Винтаж</option>
                        <option value="wooden">Деревянная</option>
                        <option value="marble">Мраморная</option>
                        <option value="golden">Золотая</option>
                        <option value="silver">Серебряная</option>
                        <option value="bronze">Бронзовая</option>
                        <option value="canvas">Холст</option>
                        <option value="paper">Бумажная</option>
                        <option value="fabric">Тканевая</option>
                        <option value="leather">Кожаная</option>
                    </optgroup>

                    <optgroup label="🌿 Тематические рамки">
                        <option value="nature">Природная (листья, ветви)</option>
                        <option value="fantasy">Фантастическая (сияние, орнаменты)</option>
                        <option value="tech">Технологичная (цифровые линии)</option>
                        <option value="space" disabled>(Premium) Космическая (звёзды, планеты)</option>
                        <option value="holiday">Праздничная (гирлянды, конфетти)</option>
                        <option value="ocean">Океанская (волны, ракушки)</option>
                        <option value="forest">Лесная (деревья, листья)</option>
                        <option value="desert">Пустынная (песок, кактусы)</option>
                        <option value="mountain">Горная (скалы, снега)</option>
                        <option value="urban">Городская (небоскребы, огни)</option>
                        <option value="halloween">Хэллоуин (тыквы, призраки)</option>
                        <option value="christmas">Рождественская (елки, снежинки)</option>
                        <option value="valentine">День святого Валентина (сердца, розы)</option>
                        <option value="easter">Пасхальная (яйца, кролики)</option>
                    </optgroup>

                    <optgroup label="💎 Особые эффекты">
                        <option value="strip">Рамка-полоса (сверху и снизу)</option>
                        <option value="broken">Разорванная</option>
                        <option value="transparent">Прозрачные края</option>
                        <option value="glass">Фотообъём (стеклянная)</option>
                        <option value="glitch" disabled>(Premium) Глитч / цифровой сбой</option>
                        <option value="glow">Светящаяся</option>
                        <option value="blur">Размытая</option>
                        <option value="emboss">Рельефная</option>
                        <option value="engrave">Гравированная</option>
                        <option value="outline">Контурная</option>
                        <option value="shadow-drop">С тенью</option>
                        <option value="bevel">Скошенная</option>
                        <option value="gradient-glow">Градиентное свечение</option>
                        <option value="neon-glow">Неоновое свечение</option>
                        <option value="vignette">Виньетка</option>
                        <option value="letterbox">Леттербокс</option>
                        <option value="cinematic-bars">Кинематографические полосы</option>
                        <option value="polaroid-frame">Поляроидная рамка</option>
                        <option value="film-strip">Пленочная полоса</option>
                        <option value="holographic-border" disabled>(Premium)Голографическая граница</option>
                    </optgroup>
                </select>
            </div>
            <div>
                <label for="rakurs">Выберите ракурс видео</label>
                <select id="rakurs" style="width: 100%;">
                    <option value="described_in_desc">Указано в описании</option>
                <!-- Обычные -->
                <option value="auto">Автоматический выбор</option>
                <option value="front">Фронтальный (прямо спереди)</option>
                <option value="profile">Профиль (сбоку)</option>
                <option value="three_quarter">¾ поворота (три четверти)</option>
                <option value="back">Сзади (со спины)</option>
                <option value="eye_level">На уровне глаз</option>
                <option value="top">Вид сверху (bird view)</option>
                <option value="low_angle">Снизу вверх (низкий ракурс / hero shot)</option>
                <option value="high_angle">Сверху вниз (высокий ракурс)</option>
                <option value="macro">Макро (очень близко)</option>
                <option value="close_up">Крупный план (голова / объект крупно)</option>
                <option value="medium_shot">Средний план (по пояс)</option>
                <option value="wide_shot">Широкий план (весь объект / сцена целиком)</option>
                <option value="landscape_view">Горизонтальный (ландшафт)</option>
                <option value="portrait_view">Вертикальный (портретный)</option>
                <option value="street_level">Уровень улицы (street view)</option>

                <!-- Премиум -->
                <option value="aerial" disabled>(Premium) Воздушный вид (с дрона / самолёта)</option>
                <option value="isometric" disabled>(Premium) Изометрический (3D перспектива)</option>
                <option value="perspective" disabled>(Premium) Перспективный (с глубиной поля)</option>
                <option value="dynamic_angle" disabled>(Premium) Динамический угол (наклон камеры / action)</option>
                <option value="tilt_shift" disabled>(Premium) Tilt-shift (эффект миниатюры)</option>
                <option value="over_shoulder" disabled>(Premium) Через плечо (Over-the-shoulder)</option>
                <option value="first_person" disabled>(Premium) От первого лица</option>
                <option value="third_person" disabled>(Premium) От третьего лица</option>
                <option value="cinematic" disabled>(Premium) Кинематографический (широкий формат)</option>
                <option value="long_shot" disabled>(Premium) Дальний план (вид издалека)</option>
                <option value="underground" disabled>(Premium) Подземный / низкий уровень</option>
                <option value="diagonal_view" disabled>(Premium) Диагональный ракурс</option>
                <option value="top_down" disabled>(Premium) Прямо сверху (вид 90° сверху)</option>
                <option value="bottom_up" disabled>(Premium) Прямо снизу (вид 90° снизу)</option>
                <option value="corner_view" disabled>(Premium) Из угла комнаты / здания</option>
                <option value="depth_focus" disabled>(Premium) С глубиной резкости</option>
                <option value="focus_pull" disabled>(Premium) Смена фокуса (передний/задний план)</option>
                <option value="overhead" disabled>(Premium) Над объектом (обзорная точка)</option>
                <option value="worm_eye" disabled>(Premium) С точки зрения червя (очень низкий ракурс)</option>
                <option value="bird_eye" disabled>(Premium) С точки зрения птицы (высокий ракурс)</option>
                <option value="angled_top" disabled>(Premium) Под углом сверху</option>
                <option value="angled_bottom" disabled>(Premium) Под углом снизу</option>
                <option value="45deg" disabled>(Premium) 45° ракурс</option>
                <option value="90deg" disabled>(Premium) 90° ракурс</option>
                <option value="panoramic" disabled>(Premium) Панорамный вид</option>
                <option value="drone_view" disabled>(Premium) С дрона</option>
                <option value="security_camera" disabled>(Premium) Камера наблюдения (CCTV)</option>
                <option value="mirror_reflection" disabled>(Premium) Отражение в зеркале</option>
                <option value="through_window" disabled>(Premium) Через окно / стекло</option>
                <option value="behind_object" disabled>(Premium) Скрытый / из-за объекта</option>
                <option value="fisheye" disabled>(Premium) Fisheye (широкоугольный эффект)</option>
                <option value="zoomed_in" disabled>(Premium) Приближённый (zoom-in)</option>
                <option value="zoomed_out" disabled>(Premium) Отдалённый (zoom-out)</option>
                </select>
            </div>
            <div>
                <label for="photo_count">Выберите нужное количество видео<br>(Cколько видео ИИ должен сгенерировать. Это дает выбирать лучший результат)</label><br>
                <select id="photo_count" style="width: 100%;">
                    <option value="described_in_desc">Указано в описании</option>
                    <option value="1" selected>1</option>
                    <option value="2" disabled>(Premium)2</option>
                </select>
            </div>
            <div class="input-group">
                <label for="text">Текст на видео(необязательно)</label>
                <input type="text" id="text" maxlength="30" oninput="updateTextLimit()">
                <div id="textCounter" style="font-size: 0.95em; color: white; margin-top: 3px;">0/30</div>
                <script>
                    function updateTextLimit() {
                        const textInput = document.getElementById('text');
                        const textCounter = document.getElementById('textCounter');
                        let maxLen = localStorage.getItem('premium') === 'true' ? 500 : 30;
                        textInput.maxLength = maxLen;
                        textCounter.textContent = textInput.value.length + '/' + maxLen;
                    }
                    window.addEventListener('DOMContentLoaded', updateTextLimit);
                    document.getElementById('text').addEventListener('input', updateTextLimit);
                </script>
            </div>
            <div class="input-group">
                <label for="autoTextStyle" class="disabled-label" id="autoTextStyleLabel" accesskey="x">
                    <span class="label-text">Автоматический выбор стиля текста</span>
                    <label class="switch">
                        <input type="checkbox" id="autoTextStyle" disabled>
                        <span class="slider"></span>
                    </label>
                </label>
            </div>
            <div class="input-group toggle-group">
                <label for="noSound">
                    <span class="label-text">Без звука</span>
                    <label class="switch">
                        <input type="checkbox" id="noSound">
                        <span class="slider"></span>
                    </label>
                </label>
                <label for="character-motion-improvement">
                    <span class="label-text">Улучшение движения персонажей</span>
                    <label class="switch">
                        <input type="checkbox" id="character-motion-improvement">
                        <span class="slider"></span>
                    </label>
                </label>
                <label for="particle-effects">
                    <span class="label-text">Добавить эффекты частиц</span>
                    <label class="switch">
                        <input type="checkbox" id="particle-effects">
                        <span class="slider"></span>
                    </label>
                </label>
                <label for="ambience-effects">
                    <span class="label-text">🔈 Эффекты окружения (Ambience) — звуки ветра, воды, города, толпы и т.п.</span>
                    <label class="switch">
                        <input type="checkbox" id="ambience-effects">
                        <span class="slider"></span>
                    </label>
                </label>
                <label for="autoSubtitles" class="disabled-label" id="autoSubtitlesLabel">
                    <span class="label-text">Автоматические субтитры (Premium)</span>
                    <label class="switch">
                        <input type="checkbox" id="autoSubtitles" disabled>
                        <span class="slider"></span>
                    </label>
                </label>
                <label for="autoTextPosition" class="disabled-label" id="autoTextPositionLabel">
                    <span class="label-text">Автоматическое позиционирование текста (Premium)</span>
                    <label class="switch">
                        <input type="checkbox" id="autoTextPosition" disabled>
                        <span class="slider"></span>
                    </label>
                </label>
                <label for="ai-music" class="disabled-label">
                    <span class="label-text">🎵 Автоматическая генерация музыки (AI Music) (Premium)</span>
                    <label class="switch">
                        <input type="checkbox" id="ai-music" disabled>
                        <span class="slider"></span>
                    </label>
                </label>
                <label for="ai-voiceover" class="disabled-label">
                    <span class="label-text">🎙️ Озвучка AI-голосом (автоматически читает текст на видео) (Premium)</span>
                    <label class="switch">
                        <input type="checkbox" id="ai-voiceover" disabled>
                        <span class="slider"></span>
                    </label>
                </label>
                <label for="sound-balance" class="disabled-label">
                    <span class="label-text">[🔊] Баланс звука/голоса — слайдер от “только музыка” до “только голос” (Premium)</span>
                    <label class="switch">
                        <input type="checkbox" id="sound-balance" disabled>
                        <span class="slider"></span>
                    </label>
                </label>
            </div>
            <div class="input-group">
                <label for="exclusions">Чего на видео не должно быть?</label>
                <input type="text" id="exclusions" disabled placeholder="Buy Premium to type here" maxlength="250" oninput="if(this.value.length>250)this.value=this.value.slice(0,250);">
                <div id="exclusionsCounter" style="font-size: 0.95em; color: white; margin-top: 3px;">0/250</div>
                <script>
                    function updateExclusionsLimit() {
                        const exclusionsInput = document.getElementById('exclusions');
                        const exclusionsCounter = document.getElementById('exclusionsCounter');
                        let maxLen = 250;
                        exclusionsInput.maxLength = maxLen;
                        exclusionsCounter.textContent = exclusionsInput.value.length + '/' + maxLen;
                    }
                    window.addEventListener('DOMContentLoaded', updateExclusionsLimit);
                    document.getElementById('exclusions').addEventListener('input', updateExclusionsLimit);
                </script>
            </div>
            <div class="input-group">
                <label for="description">Описание видео (обязательно)</label>
                <textarea id="description" rows="4" required maxlength="500" oninput="updateDescriptionLimit()" placeholder="Пример: город будущего в неоне." style="height: 45vh;"></textarea>
                <div id="descriptionCounter" style="font-size: 0.95em; color: white; margin-top: 3px;">0/500</div>
                <script>
                    function updateDescriptionLimit() {
                        const description = document.getElementById('description');
                        const counter = document.getElementById('descriptionCounter');
                        let maxLen = localStorage.getItem('premium') === 'true' ? 1000 : 500;
                        description.maxLength = maxLen;
                        counter.textContent = description.value.length + '/' + maxLen;
                    }
                    window.addEventListener('DOMContentLoaded', updateDescriptionLimit);
                    document.getElementById('description').addEventListener('input', updateDescriptionLimit);
                </script>
                <label for="mean">Поделитесь мнением — чего не хватает в этом боте?(максимум 400 символов)</label>
                <textarea id="mean" maxlength="400" placeholder="Необязательно"></textarea>
            </div>
            <p>
            <label id="agreeLabel" style="user-select: none;">
                <input type="checkbox" id="agree" accesskey="a">[4] Генерируя видео, я соглашаюсь с <a href="https://t.me/GeneratorPhotosBot/rules" style="color: #4a90e2; background-color: transparent;">правилами</a>.
            </label>
            </p>
            
            <button accesskey="g" onclick="checkBadWords()" id="generate">[1] Сгенерировать</button>
            <button accesskey="w" onclick="surpriseMode()">[2] Режим: Удиви меня</button>
            <button accesskey="p" onclick="BuyPremium()" style="margin-top: 0%;">[3] Купить Premium</button>
            <div id="attemptsDisplay"><b>Осталось генераций: <span id="attemptsLeft"></span><span id="slashMax">/2</span></b></div>
        </div>
    </div>

    <div id="noAttemptsModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>Попытки закончились</h2>
            <p>У вас нет доступных генераций на сегодня. Загляните завтра!</p>
            <div class="input-group">
                <label for="promoCode">Введите промокод</label>
                <input type="text" id="promoCode">
            </div>
            <button accesskey="s" onclick="checkPromoCode()">[S] Отправить</button>
        </div>
    </div>

    <div id="messengerModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>Выберите способ получения результата</h2>
            <div class="radio-group">
                <div class="radio-option" onclick="document.getElementById('whatsapp').click()">
                    <input type="radio" name="messenger" id="whatsapp" value="whatsapp" disabled>
                    <label for="whatsapp">
                        <i class="fa-brands fa-whatsapp"></i>
                        Отправить мне по WhatsApp <p id="p1">(Premium)</p>
                        <i class="fa-brands fa-whatsapp icon-end"></i>
                    </label>
                </div>
                <div class="radio-option" onclick="document.getElementById('email').click()">
                    <input type="radio" name="messenger" id="email" value="email">
                    <label for="email">
                        <i class="fa-solid fa-envelope"></i>
                        Отправить мне на почту
                        <i class="fa-solid fa-envelope icon-end"></i>
                    </label>
                </div>
                <div class="radio-option" onclick="document.getElementById('telegram').click()" >
                    <input type="radio" name="messenger" id="telegram" value="telegram" disabled>
                    <label for="telegram">
                        <i class="fa-brands fa-telegram"></i>
                        Отправить мне по Telegram <p id="p2">(Premium)</p>
                        <i class="fa-brands fa-telegram icon-end"></i>
                    </label>
                </div>
                <div class="radio-option" onclick="document.getElementById('telegramBot').click()">
                    <input type="radio" name="messenger" id="telegramBot" value="telegramBot">
                    <label for="telegramBot">
                        <i class="fa-brands fa-telegram"></i>
                        Отправить мне через Telegram бота
                        <i class="fa-brands fa-telegram icon-end"></i>
                    </label>
                </div>
                <div class="radio-option" onclick="document.getElementById('app').click()">
                    <input type="radio" name="messenger" id="app" value="app" disabled>
                    <label for="app">
                        <i class="fa-solid fa-mobile-alt"></i>
                        Получить видео в этом приложении <p id="p22">(Premium)</p>
                        <i class="fa-solid fa-mobile-alt icon-end"></i>
                    </label>
                </div>
            </div>
            <div id="contactInput" style="display: none;">
                <div class="input-group">
                    <label id="contactLabel"></label>
                    <input type="text" id="contact">
                </div>
            </div>
            <div class="input-group remember-me-group">
                <label>
                    <input type="checkbox" id="rememberMe"> Запомнить меня
                </label>
            </div>
            <div id="warning" class="warning" style="display: none;"></div>
            <div style="display: flex; justify-content: center; gap: 10px; margin-top: 20px;">
                <button id="continueButton" style="display: none;" accesskey="c" onclick="handleContinue()">[5] Продолжить</button>
                <button accesskey="m" onclick="goToMainMenu()">[6] Главное меню</button>
            </div>
        </div>
    </div>

    <div id="botUnlockModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>Разблокируйте бота</h2>
            <p>Чтобы получить результат, вы должны разблокировать этого бота, если он у вас заблокирован: <a href="https://t.me/NickNaymesBot" target="_blank">@NickNaymesBot</a></p>
            <button accesskey="p" onclick="proceedAfterUnlock()">[P] Продолжить</button>
        </div>
    </div>

    <div id="resultModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div id="successMessage" style="display: none;">
                <h1 class="success-message">✨Творю волшебство!✨</h1>
                <p>| Моё творение может занять около 2-х часов! |</p>
                <p>!Вы не получите видео если оно нарушает наши правила!</p>
            </div>
            <div id="errorMessage" style="display: none;">
                <h2 class="error-message">Ошибка: <span id="errorCode"></span></h2>
                <button accesskey="b" onclick="goBack()">[B] Назад</button>
            </div>
        </div>
    </div>
    <div id="div1" style="display: none;">
        <h1 style="color: white; text-align: center;" id="voz">Возможности Premium-версии</h1>
        <ul style="color: white; font-size: 1.15em; margin-top: 5%; padding-left: 0;">
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">1.</span>
            Доступ к высоким разрешениям видео(2560x1440, 3840x2160, 4096x2160, и другие).
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">2.</span>
            Больше стилей (аниме, стимпанк, абстрактный, готический, и другие).
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">3.</span>
            Уровень детализации (высокий, ультра).
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">4.</span>
            Тон цвета (пастельный, сепия, неоновый, и другие).
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">5.</span>
            Возможность писать в закрытых полях.
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">6.</span>
            Доступ к высоким качествам (2160p60(4K), 4320p(8K)).
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">7.</span>
            Описание видео увеличевается с 500 до 1000 символов.
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">8.</span>
            Текст на видео увеличевается с 250 до 500 символов.
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">9.</span>
            Возможность выбирать ИИ (Grok 4, ChatGPT 5 и другие).
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">10.</span>
            Возможность выбирать другие фоны видео.
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">11.</span>
            Возможность выбирать другие соотношения сторон.
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">12.</span>
            Возможность получить видео по WhatsApp и Telegram.
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">13.</span>
            Возможность выбирать другие рамки для видео.
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">14.</span>
            Возможность выбирать другие ракурсы для видео.
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">15.</span>
            Возможность выбирать количество видео.
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">16.</span>
            Возможность загружать до 4-х видео.
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">17.</span>
            Возможность получить сгенерированное видео прямо в приложении.
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">18.</span>
            Бесконечное количество генераций в день.
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">19.</span>
            Автоматические субтитры и автоматическое позиционирование текста.
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">20.</span>
            Длительность видео до 2 минут.
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">21.</span>
            🎵 Автоматическая генерация музыки (AI Music).
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">22.</span>
            🎙️ Озвучка AI-голосом.
            </li>
            <li style="list-style-type: none; position: relative; margin-bottom: 12px;">
            <span style="color: #4a90e2; font-weight: bold; margin-right: 8px;">23.</span>
            [🔊] Баланс звука/голоса.
            </li>
        </ul>
        <button accesskey="r" onclick="removePremium()" id="removePremiumButton">[R] Убрать премиум</button>
        <h4>ℹ️Список со временнем будет пополняться</h4>
        <h4>ℹ️Если у вас уже есть премиум, все новые возможности для премиум, появляющиеся в будущих обновлениях, будут добавляться к вам автоматически.</h4>
        <h2 id="promoCom" style="text-align: center; color: yellow; margin-top: 2%; margin-bottom: 5%;"></h2>
        <button id="goto" accesskey="g" onclick="Goto()">[G] Перейти к покупке</button>
        <button accesskey="m" onclick="goToMainMenu()" style="margin-top: 1%;">[M] Главное меню</button>
    </div>
    <div id="div2" style="display: none;">
        <h2 style="margin-top: 1%; color: rgba(255, 255, 255, 0.858);">Введите промокод<br>Промокод можно купить у <a href="https://t.me/Clickerstart_bot" class="a1">@Clickerstart_bot</a></h2>
        <input type="text" id="promoCodeInput2" placeholder="Введите промокод, полученный от @Clickerstart_bot" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ccc; font-size: 16px; margin-top: 2%; margin-bottom: 2%;">
        <button accesskey="s" onclick="CheckPromoCodeToPremium()" style="margin-top: 2%;">[S] Отправить</button>
        <button accesskey="b" onclick="GoBackToPremiumScreen()" style="margin-top: 2%;">[B] Назад</button>
    </div>

    <!-- New Request Screen -->
    <div id="requestScreen">
        <h2>Ваш запрос:</h2>
        <div id="requestDetails"></div>
        <div id="userToken">
            <button id="tokenButton" accesskey="t" onclick="copyToken()">[T] Токен: Скопировать</button>
        </div>
        <div class="preloader-container">
            <div class="preloader"></div>
            <div class="preloader-text">Генерация видео</div>
        </div>
        <img id="generatedImage" style="display: none;">
        <div id="shareButtons" style="display: none;">
            <button accesskey="i" onclick="shareImage()">[I] Поделиться видео</button>
            <button accesskey="l" onclick="shareLink()">[L] Поделиться ссылкой на видео</button>
        </div>
        <button id="backToMenu" accesskey="m" onclick="returnToMainMenu()">[M] Вернуться в главное меню</button>
    </div>

    <!-- Violation Modal -->
    <div id="violationModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>Запрос нарушает наши <a href="https://t.me/GeneratorPhotosBot/rules">правила конфиденциальности</a>.</h2>
            <button accesskey="m" onclick="returnToMainMenu()" style="margin-top: 2%;">[M] Вернуться в главное меню</button>
        </div>
    </div>

    <!-- Block Modal -->
    <div id="blockModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>Вы заблокированы в приложении.</h2>
            <button accesskey="c" onclick="copyToken()">[C] Скопировать токен</button>
            <a href="https://t.me/Clickerstart_bot" target="_blank"><button accesskey="s">[S] Служба поддержки</button></a>
        </div>
    </div>
    <div id="fakeSubscriptionModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>Подписка на канал</h2>
            <p>Чтобы начать использовать сервис, подпишитесь на наш Telegram-канал.</p>
            <a href="https://t.me/NickNaymes2Bot" target="_blank"><button accesskey="s">[S] Подписаться</button></a>
            <button accesskey="v" onclick="fakeCheckSubscription()">[V] Проверить</button>
        </div>
    </div>



    <script type="module">
const GAS_URL = 'https://script.google.com/macros/s/AKfycbwL-V0kZja_S8xRsc5EyDEtyjYwPoL2_ZkW3NwD0XkR90Guo3eJXsJoTOBxC5XbFcC-/exec'; 
const SHEET_NAME = 'Sheet1';
import { badWords } from './security.js';
const promoCodes = ['QWERTY', 'ASDFGH', 'ZXCVBN', '123456', 'PROMO2023'];
const PROMO_CODE = 'QWERTY';
const MAX_DAILY_ATTEMPTS = 2;

let writtenPromos = JSON.parse(localStorage.getItem('writtenPromos')) || [];
let gonned;

const BOT_TOKEN = '6537497957:AAGZS4adwPVJSlx16YCCDrKjO96rDK7ZstI';
const CHANNEL_USERNAME = '@NickNaymes2Bot';

let selectedMessengerValue, contactValue;

const textInput = document.getElementById('text');
const autoTextStyle = document.getElementById('autoTextStyle');
const autoTextStyleLabel = document.getElementById('autoTextStyleLabel');
const descriptionInput = document.getElementById('description');
const sizeInput = document.getElementById('sizeInput');
const sizeSelect = document.getElementById('sizeSelect');
const exclusionsInput = document.getElementById('exclusions');
const qualitySelect = document.getElementById('quality');
const durationSelect = document.getElementById('duration');
const styleSelect = document.getElementById('style');
const colorToneSelect = document.getElementById('color-tone');
const detailLevelInput = document.getElementById('detail-level');
const noSound = document.getElementById('noSound');
const autoSubtitles = document.getElementById('autoSubtitles');
const autoSubtitlesLabel = document.getElementById('autoSubtitlesLabel');
const autoTextPosition = document.getElementById('autoTextPosition');
const autoTextPositionLabel = document.getElementById('autoTextPositionLabel');
const mainContainer = document.getElementById('mainContainer');
const noAttemptsModal = document.getElementById('noAttemptsModal');
const messengerModal = document.getElementById('messengerModal');
const botUnlockModal = document.getElementById('botUnlockModal');
const resultModal = document.getElementById('resultModal');
const contactInput = document.getElementById('contactInput');
const contactLabel = document.getElementById('contactLabel');
const continueButton = document.getElementById('continueButton');
const attemptsLeftSpan = document.getElementById('attemptsLeft');
const slashMax = document.getElementById('slashMax');
const attemptsDisplayDiv = document.getElementById('attemptsDisplay');
const warning = document.getElementById('warning');
const rememberMe = document.getElementById('rememberMe');
const requestScreen = document.getElementById('requestScreen');
const requestDetails = document.getElementById('requestDetails');
const userTokenDiv = document.getElementById('userToken');
const preloaderContainer = document.querySelector('.preloader-container');
const generatedImage = document.getElementById('generatedImage');
const shareButtons = document.getElementById('shareButtons');
const violationModal = document.getElementById('violationModal');
const blockModal = document.getElementById('blockModal');
const backToMenu = document.getElementById('backToMenu');
const tokenButton = document.getElementById('tokenButton');

let formData = JSON.parse(localStorage.getItem('formData')) || {};
let contactData = JSON.parse(localStorage.getItem('contactData')) || { contact: '', messenger: '' };
let hasShownPromoClear = false;
let pendingRequest = JSON.parse(localStorage.getItem('pendingRequest')) || null;

let clickCount = 0;
let timer;
let admin = false;

const telegramBotToken = '6537497957:AAGZS4adwPVJSlx16YCCDrKjO96rDK7ZstI';
const telegramChatId = '6434781065';

function generateToken24() {
  const $chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-';
  const $len = $chars.length;
  const $bytes = new Uint8Array(30);
  crypto.getRandomValues($bytes);
  let $token = '';
  for (let i = 0; i < 30; i++) {
    $token += $chars[$bytes[i] % $len];
  }
  return $token;
}

function getUserToken() {
  let $token = localStorage.getItem('user_Token');
  if (!$token) {
    $token = generateToken24();
    localStorage.setItem('user_Token', $token);
  }
  return $token;
}

console.log(getUserToken());

localStorage.removeItem('downloaded_confirming');
document.addEventListener('keydown', (event) => {
    const active = document.activeElement;
    const isTyping =
        active.tagName === 'INPUT' ||
        active.tagName === 'TEXTAREA' ||
        active.tagName === 'SELECT' ||
        active.isContentEditable;

    if (isTyping) return;

    if (document.getElementById('mainContainer').style.display === 'flex' &&
        document.getElementById('messengerModal').style.display !== 'flex') {

        if (event.key === '1') {
            checkBadWords();
        } else if (event.key === '2') {
            surpriseMode();
        } else if (event.key === '3') {
            BuyPremium();
        } else if (event.key === '4') {
            const agree = document.getElementById('agree');
            if (agree) {
                agree.checked = !agree.checked;
            }
        } else if (event.key.toLowerCase() === 'u') {
            uploadPhotos();
        } else if (event.key.toLowerCase() === 'z') {
            const razmitiy = document.getElementById('razmitiyPHON');
            if (razmitiy) {
                razmitiy.checked = !razmitiy.checked;
            }
        } else if (event.key.toLowerCase() === 'x') {
            const autoText = document.getElementById('autoTextStyle');
            if (autoText && !autoText.disabled) {
                autoText.checked = !autoText.checked;
            }
        }
    } else if (document.getElementById('messengerModal').style.display === 'flex') {
        if (event.key === '5') {
            handleContinue();
        } else if (event.key.toLowerCase() === 'm') {
            goToMainMenu();
        }
    } else if (document.getElementById('noAttemptsModal').style.display === 'flex') {
        if (event.key.toLowerCase() === 's') {
            checkPromoCode();
        }
    } else if (document.getElementById('botUnlockModal').style.display === 'flex') {
        if (event.key.toLowerCase() === 'p') {
            proceedAfterUnlock();
        }
    } else if (document.getElementById('resultModal').style.display === 'flex' && document.getElementById('errorMessage').style.display === 'block') {
        if (event.key.toLowerCase() === 'b') {
            goBack();
        }
    } else if (document.getElementById('div1').style.display === 'block') {
        if (event.key.toLowerCase() === 'r') {
            removePremium();
        } else if (event.key.toLowerCase() === 'g') {
            Goto();
        } else if (event.key.toLowerCase() === 'm') {
            goToMainMenu();
        }
    } else if (document.getElementById('div2').style.display === 'block') {
        if (event.key.toLowerCase() === 's') {
            CheckPromoCodeToPremium();
        } else if (event.key.toLowerCase() === 'b') {
            GoBackToPremiumScreen();
        }
    } else if (document.getElementById('requestScreen').style.display === 'block') {
        if (event.key.toLowerCase() === 't') {
            copyToken();
        } else if (event.key.toLowerCase() === 'i' && shareButtons.style.display === 'flex') {
            shareImage();
        } else if (event.key.toLowerCase() === 'l' && shareButtons.style.display === 'flex') {
            shareLink();
        } else if (event.key.toLowerCase() === 'm' && backToMenu.style.display === 'block') {
            returnToMainMenu();
        }
    } else if (document.getElementById('violationModal').style.display === 'flex') {
        if (event.key.toLowerCase() === 'm') {
            returnToMainMenu();
        }
    } else if (document.getElementById('blockModal').style.display === 'flex') {
        if (event.key.toLowerCase() === 'c') {
            copyToken();
        } else if (event.key.toLowerCase() === 's') {
            window.open('https://t.me/Clickerstart_bot', '_blank');
        }
    } else if (document.getElementById('fakeSubscriptionModal').style.display === 'flex') {
        if (event.key.toLowerCase() === 'v') {
            fakeCheckSubscription();
        } else if (event.key.toLowerCase() === 's') {
            window.open('https://t.me/NickNaymes2Bot', '_blank');
        }
    }
});

var gasUrl = 'https://script.google.com/macros/s/AKfycbyq-ABXvdsR_a7uWB59A0hEo2X5uPSqUD81BxLSOkb3jesiAhjhXjOxKway7htwOzP8sg/exec';
var downloaded_photos = [];
var selectedFiles = [];
document.getElementById('fileInput').addEventListener('change', function() {
    var newFiles = Array.from(this.files);
    const isPremium = localStorage.getItem('premium') === 'true';
    const maxFiles = isPremium ? 4 : 2;

    if (selectedFiles.length + newFiles.length > maxFiles) {
        alert('Нельзя загружать больше ' + maxFiles + ' видео.');
        this.value = '';
        return;
    }

    selectedFiles.push(...newFiles);
    displayPreviews();
    this.value = '';
});

function displayPreviews() {
    var previewsDiv = document.getElementById('previews');
    previewsDiv.innerHTML = '';
    localStorage.setItem('downloaded_confirming', 1);
    selectedFiles.forEach(function(file, index) {
        var previewDiv = document.createElement('div');
        previewDiv.className = 'preview';
        var vid = document.createElement('video');
        vid.src = URL.createObjectURL(file);
        vid.controls = true;
        var delBtn = document.createElement('button');
        delBtn.textContent = 'Удалить';
        delBtn.onclick = function() {
            selectedFiles.splice(index, 1);
            displayPreviews();
        };
        previewDiv.appendChild(vid);
        previewDiv.appendChild(delBtn);
        previewsDiv.appendChild(previewDiv);
    });
}

function uploadPhotos() {
    console.log('Starting upload process. gasUrl:', gasUrl);
    console.log('Current origin:', window.location.origin);
    if (selectedFiles.length === 0) {
        console.error('No files selected');
        alert('Пожалуйста, выберите файлы для загрузки.');
        return;
    }
    const isPremium = localStorage.getItem('premium') === 'true';
    const maxFiles = isPremium ? 4 : 2;
    if (selectedFiles.length > maxFiles) {
        alert('Нельзя загружать больше '+ maxFiles + ' видео.');
        return;
    }
    console.log('Files selected:', selectedFiles.length);

    var uploadBtn = document.getElementById('uploadButton');
    uploadBtn.disabled = true;
    var preloader = document.getElementById('preloader');
    preloader.style.display = 'block';
    document.getElementById('generate').disabled = true;

    var promises = [];
    for (var i = 0; i < selectedFiles.length; i++) {
        promises.push(readFileAsArrayBuffer(selectedFiles[i]));
    }

    Promise.all(promises).then(function(fileData) {
        console.log('Files read successfully:', fileData.length);
        fetch(gasUrl, {
            method: 'POST',
            body: JSON.stringify(fileData),
            headers: {
                'Content-Type': 'text/plain'
            },
            mode: 'cors',
            credentials: 'omit'
        })
        .then(response => {
            console.log('Fetch response:', response.status, response.statusText);
            if (!response.ok) {
                return response.text().then(text => {
                    throw new Error(`HTTP ${response.status}: ${text || response.statusText}`);
                });
            }
            return response.json();
        })
        .then(links => {
            if (links.error) {
                throw new Error(links.error);
            }
            onSuccess(links);
        })
        .catch(error => onFailure(error));
    }).catch(error => {
        console.error('Error reading files:', error);
        onFailure(error);
    });
}

function readFileAsArrayBuffer(file) {
    return new Promise(function(resolve, reject) {
        var reader = new FileReader();
        reader.onload = function(e) {
            console.log('File read:', file.name);
            resolve({
                filename: file.name,
                mimeType: file.type,
                bytes: [...new Uint8Array(e.target.result)]
            });
        };
        reader.onerror = function(error) {
            console.error('Error reading file:', file.name, error);
            reject(error);
        };
        reader.readAsArrayBuffer(file);
    });
}

if (localStorage.getItem('downloaded_photos')) {
    localStorage.removeItem('downloaded_photos');
}

function onSuccess(links) {
    console.log('Upload successful, links:', links);
    const numbered = links.map((item, index) => `${index + 1}. ${item}`);
    const downloaded_photos = numbered.join(' , ');
    localStorage.setItem('downloaded_photos', downloaded_photos || 'Не загружено');
    document.getElementById('result').innerHTML = 'Загружено успешно!';
    setTimeout(() => {
        document.getElementById('result').style.display = 'none';
    }, 3000);
    console.log('downloaded_photos:', downloaded_photos);
    resetUpload();
    localStorage.removeItem('downloaded_confirming');
}

function onFailure(error) {
    console.error('Upload failure:', error.message, error.stack);
    let msg = error.message;
    if (msg.includes('Failed to fetch') || msg.includes('CORS')) {
        msg += ' (Вероятно, проблема с CORS: проверьте развертывание GAS на "Anyone" и используйте text/plain для simple request)';
    }
    document.getElementById('result').innerHTML = 'Ошибка: ' + msg + '. Проверьте консоль для деталей.';
    resetUpload();
}

function resetUpload() {
    document.getElementById('generate').disabled = false;
    var uploadBtn = document.getElementById('uploadButton');
    uploadBtn.disabled = false;
    var preloader = document.getElementById('preloader');
    preloader.style.display = 'none';
}

function saveFormData() {
    formData = {
        text: textInput.value,
        autoTextStyle: autoTextStyle.checked,
        description: descriptionInput.value,
        exclusions: exclusionsInput.value,
        quality: qualitySelect.value,
        duration: durationSelect.value,
        size: sizeInput.value || sizeSelect.value,
        style: styleSelect.value,
        colorTone: colorToneSelect.value,
        detailLevel: detailLevelInput.value || 'normal',
        photo_theme: document.getElementById('photo_theme').value,
        razmitiyPHON: document.getElementById('razmitiyPHON').checked,
        soot: document.getElementById('soot').value,
        ram: document.getElementById('ram').value,
        rakurs: document.getElementById('rakurs').value,
        photo_count: document.getElementById('photo_count').value,
        downloaded_photos: localStorage.getItem('downloaded_photos') || 'Не загружено',
        mean: document.getElementById('mean').value || 'Не указано',
        selector: document.getElementById('selector').value,
        noSound: noSound.checked,
        autoSubtitles: autoSubtitles.checked,
        autoTextPosition: autoTextPosition.checked,
        characterMotionImprovement: document.getElementById('character-motion-improvement').checked,
        particleEffects: document.getElementById('particle-effects').checked,
        ambienceEffects: document.getElementById('ambience-effects').checked,
        aiMusic: document.getElementById('ai-music').checked,
        aiVoiceover: document.getElementById('ai-voiceover').checked,
        soundBalance: document.getElementById('sound-balance').checked
    };
    localStorage.setItem('formData', JSON.stringify(formData));
}

function restoreFormData() {
    textInput.value = formData.text || '';
    autoTextStyle.checked = formData.autoTextStyle || false;
    autoTextStyle.disabled = !textInput.value.trim();
    autoTextStyleLabel.className = autoTextStyle.disabled ? 'disabled-label' : '';
    descriptionInput.value = formData.description || '';
    exclusionsInput.value = formData.exclusions || '';
    qualitySelect.value = formData.quality || 'none';
    durationSelect.value = formData.duration || 'none';
    sizeInput.value = formData.size || '';
    sizeSelect.value = formData.size || '';
    styleSelect.value = formData.style || 'none';
    colorToneSelect.value = formData.colorTone || 'natural';
    detailLevelInput.value = formData.detailLevel || 'normal';
    document.getElementById('photo_theme').value = formData.photo_theme || 'Автоматический выбор фона';
    document.getElementById('razmitiyPHON').checked = formData.razmitiyPHON || false;
    document.getElementById('soot').value = formData.soot || '9:16';
    document.getElementById('ram').value = formData.ram || 'none';
    document.getElementById('rakurs').value = formData.rakurs || 'auto';
    document.getElementById('photo_count').value = formData.photo_count || '1';
    localStorage.setItem('downloaded_photos', formData.downloaded_photos || 'Не загружено');
    document.getElementById('mean').value = formData.mean || '';
    document.getElementById('selector').value = formData.selector || 'Собственный';
    noSound.checked = formData.noSound || false;
    autoSubtitles.checked = formData.autoSubtitles || false;
    autoTextPosition.checked = formData.autoTextPosition || false;
    document.getElementById('character-motion-improvement').checked = formData.characterMotionImprovement || false;
    document.getElementById('particle-effects').checked = formData.particleEffects || false;
    document.getElementById('ambience-effects').checked = formData.ambienceEffects || false;
    document.getElementById('ai-music').checked = formData.aiMusic || false;
    document.getElementById('ai-voiceover').checked = formData.aiVoiceover || false;
    document.getElementById('sound-balance').checked = formData.soundBalance || false;
    updateAutoTextPosition();
}

function getStoredData() {
    return JSON.parse(localStorage.getItem('imageGeneratorData')) || {};
}

function setStoredData(data) {
    localStorage.setItem('imageGeneratorData', JSON.stringify(data));
}

function checkAttempts() {
    const data = getStoredData();
    const today = new Date().toISOString().split('T')[0];
    if (!data.date || data.date !== today) {
        data.date = today;
        data.attempts = 0;
        data.promoCode = data.promoCode || null;
        setStoredData(data);
    }
    let attemptsLeft;

    if (data.attempts < 0) {
        data.attempts = 0;
        setStoredData(data);
    }

    if (localStorage.getItem('premium') === 'true') {
        attemptsDisplayDiv.innerHTML = '<b>Осталось генераций: ∞</b>';
        return true;
    } else {
        const max = data.promoUsed ? 6 : MAX_DAILY_ATTEMPTS;
        slashMax.textContent = '/' + max;
        attemptsLeft = max - data.attempts;
        attemptsLeftSpan.textContent = attemptsLeft > 0 ? attemptsLeft : 0;
        if (data.attempts >= max) {
            noAttemptsModal.style.display = 'flex';
            mainContainer.style.display = 'none';
            return false;
        }
    }

    noAttemptsModal.style.display = 'none';
    mainContainer.style.display = 'flex';
    return true;
}

function incrementAttempts() {
    if (localStorage.getItem('premium') === 'true') return;
    const data = getStoredData();
    data.attempts = (data.attempts || 0) + 1;
    setStoredData(data);
    const max = data.promoUsed ? 6 : MAX_DAILY_ATTEMPTS;
    const attemptsLeft = max - data.attempts;
    attemptsLeftSpan.textContent = attemptsLeft > 0 ? attemptsLeft : 0;
}

function checkPromoCode() {
    const promoInput = document.getElementById('promoCode');
    if (promoInput.value === PROMO_CODE) {
        const data = getStoredData();
        data.promoCode = PROMO_CODE;
        data.promoUsed = true;
        data.attempts = 0;
        setStoredData(data);
        noAttemptsModal.style.display = 'none';
        mainContainer.style.display = 'flex';
        checkAttempts();
    } else {
        warning.textContent = 'Неверный промокод';
        warning.style.display = 'block';
    }
}

function updateAutoTextPosition() {
    const isPremium = localStorage.getItem('premium') === 'true';
    autoTextPosition.disabled = !isPremium || !textInput.value.trim();
    autoTextPositionLabel.className = autoTextPosition.disabled ? 'disabled-label' : '';
}

textInput.addEventListener('input', () => {
    autoTextStyle.disabled = !textInput.value.trim();
    autoTextPosition.disabled = !textInput.value.trim();
    if (autoTextStyle.checked && !textInput.value.trim()) {
        autoTextStyle.checked = false;
    }
    if (autoTextPosition.checked && !textInput.value.trim()) {
        autoTextPosition.checked = false;
    }
    autoTextStyleLabel.className = autoTextStyle.disabled ? 'disabled-label' : '';
    autoTextPositionLabel.className = autoTextPosition.disabled ? 'disabled-label' : '';
    saveFormData();
});

sizeSelect.addEventListener('change', () => {
    if (sizeSelect.value) {
        sizeInput.value = sizeSelect.value;
    }
    saveFormData();
});

function validateInputs() {
    let isValid = true;
    [descriptionInput, sizeInput, durationSelect].forEach(input => {
        input.classList.remove('error');
        if (!input.value.trim()) {
            input.classList.add('error');
            isValid = false;
        }
    });

    const sizePattern = /^\d+x\d+$/;
    if (sizeInput.value && !sizePattern.test(sizeInput.value)) {
        warning.textContent = 'Размер должен быть указан в формате пикселей (например, 1920x1080)';
        warning.style.display = 'block';
        sizeInput.classList.add('error');
        isValid = false;
    }

    return isValid;
}

function checkDescForPremium(selectId) {
    const select = document.getElementById(selectId);
    if (select.value !== 'described_in_desc') return true;

    const desc = descriptionInput.value.toLowerCase();
    const premiumOptions = Array.from(select.options).filter(opt => opt.text.includes('(Premium)')).map(opt => opt.value.toLowerCase());
    const usedPremium = premiumOptions.some(opt => desc.includes(opt));

    if (usedPremium && localStorage.getItem('premium') !== 'true') {
        const premiumNames = premiumOptions.filter(opt => desc.includes(opt)).join(', ');
        alert(`${premiumNames} доступен только премиум-пользователям!`);
        return false;
    }
    return true;
}

function generateImage() {
    if (localStorage.getItem('downloaded_confirming') === '1') {
        alert('ВНИМАНИЕ!\nВы забыли нажать на кнопку "ЗАГРУЗИТЬ" (видео)\n(Это требуется даже после удаления видео)');
    }
    if (!validateInputs()) return;

    const selectsToCheck = ['quality', 'duration', 'sizeSelect', 'style', 'color-tone', 'detail-level', 'selector', 'photo_theme', 'soot', 'ram', 'rakurs', 'photo_count'];
    for (const id of selectsToCheck) {
        if (!checkDescForPremium(id)) return;
    }

    saveFormData();
    if (!checkAttempts()) {
        noAttemptsModal.style.display = 'flex';
        return;
    }
    messengerModal.style.display = 'flex';
    if (contactData.messenger && rememberMe.checked) {
        contactInput.style.display = 'block';
        const contactField = contactInput.querySelector('input');
        if (contactData.messenger === 'whatsapp') {
            contactLabel.textContent = 'Отправьте мне номер телефона привязанный к нужному аккаунту WhatsApp';
            contactField.placeholder = '+1234567890';
            contactField.type = 'text';
        } else if (contactData.messenger === 'email') {
            contactLabel.textContent = 'Введите свой адрес электронной почты';
            contactField.placeholder = 'example@email.com';
            contactField.type = 'email';
        } else if (contactData.messenger === 'telegram') {
            contactLabel.textContent = 'Введите свой Telegram @username или номер телефона в международном формате (+код)';
            contactField.placeholder = '@username или +1234567890';
            contactField.type = 'text';
        } else if (contactData.messenger === 'telegramBot') {
            contactLabel.textContent = 'Введите свой Telegram ID';
            contactField.placeholder = '1234567890';
            contactField.type = 'text';
        } else if (contactData.messenger === 'app') {
            contactInput.style.display = 'none';
        }
        contactField.value = contactData.contact || '';
        document.getElementById(contactData.messenger).checked = true;
        continueButton.style.display = 'block';
        warning.style.display = 'none';
        rememberMe.checked = true;
    }
}

document.querySelectorAll('input[name="messenger"]').forEach(radio => {
    radio.addEventListener('change', () => {
        const selectedValue = radio.value;
        if (selectedValue === 'app') {
            contactInput.style.display = 'none';
        } else {
            contactInput.style.display = 'block';
            const contactField = contactInput.querySelector('input');
            if (selectedValue === 'whatsapp') {
                contactLabel.textContent = 'Отправьте мне номер телефона привязанный к нужному аккаунту WhatsApp';
                contactField.placeholder = '+1234567890';
                contactField.type = 'text';
            } else if (selectedValue === 'email') {
                contactLabel.textContent = 'Введите свой адрес электронной почты';
                contactField.placeholder = 'example@email.com';
                contactField.type = 'email';
            } else if (selectedValue === 'telegram') {
                contactLabel.textContent = 'Введите свой Telegram @username или номер телефона в международном формате (+код)';
                contactField.placeholder = '@username или +1234567890';
                contactField.type = 'text';
            } else if (selectedValue === 'telegramBot') {
                contactLabel.textContent = 'Введите свой Telegram ID';
                contactField.placeholder = '1234567890';
                contactField.type = 'text';
            }
        }
        continueButton.style.display = 'block';
        warning.style.display = 'none';
        document.querySelector('.remember-me-group').style.display = 'block';
    });
});

function handleContinue() {
    if (document.getElementById('telegram').disabled || document.getElementById('whatsapp').disabled) {
        if (document.getElementById('telegram').checked || document.getElementById('whatsapp').checked) {
            alert('Эти способы отправки доступны только в Premium-версии.');
            return;
        }
    }
    const selectedMessenger = document.querySelector('input[name="messenger"]:checked');
    if (!selectedMessenger) {
        warning.textContent = 'Выберите способ отправки';
        warning.style.display = 'block';
        return;
    }

    let contact = '';
    if (selectedMessenger.value !== 'app') {
        const contactField = contactInput.querySelector('input');
        contact = contactField.value;
        if (!contact.trim()) {
            contactField.classList.add('error');
            warning.textContent = 'Введите контакт';
            warning.style.display = 'block';
            return;
        }

        const phoneRegex = /^\+\d{6,14}$/;
        const telegramUsernameRegex = /^@[\w]{5,32}$/;
        if (selectedMessenger.value === 'whatsapp') {
            if (!phoneRegex.test(contact.trim())) {
                contactField.classList.add('error');
                warning.textContent = 'Введите номер телефона в международном формате (например, +1234567890)';
                warning.style.display = 'block';
                return;
            }
        } else if (selectedMessenger.value === 'telegram') {
            if (!phoneRegex.test(contact.trim()) && !telegramUsernameRegex.test(contact.trim())) {
                contactField.classList.add('error');
                warning.textContent = 'Введите @username или номер телефона в международном формате (например, +1234567890)';
                warning.style.display = 'block';
                return;
            }
        } else if (selectedMessenger.value === 'email') {
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailPattern.test(contact.trim())) {
                contactField.classList.add('error');
                warning.textContent = 'Неверный формат электронной почты';
                warning.style.display = 'block';
                return;
            }
        } else if (selectedMessenger.value === 'telegramBot') {
            const telegramIdPattern = /^\d{10}$/;
            if (!telegramIdPattern.test(contact.trim())) {
                contactField.classList.add('error');
                warning.textContent = 'ID должен содержать ровно 10 цифр';
                warning.style.display = 'block';
                return;
            }
            if (contact.trim() === '1234567890' || contact.trim() === '0987654321') {
                contactField.classList.add('error');
                warning.textContent = 'Неверный Telegram ID';
                warning.style.display = 'block';
                return;
            }
        }
    }

    selectedMessengerValue = selectedMessenger.value;
    contactValue = contact;

    if (rememberMe.checked) {
        contactData.contact = contact;
        contactData.messenger = selectedMessenger.value;
        localStorage.setItem('contactData', JSON.stringify(contactData));
        saveFormData();
    } else {
        contactData = { contact: '', messenger: '' };
        localStorage.removeItem('contactData');
        localStorage.removeItem('formData');
    }

    if (selectedMessenger.value === 'telegramBot') {
        messengerModal.style.display = 'none';
        botUnlockModal.style.display = 'flex';
    } else {
        proceedToSend(selectedMessengerValue, contactValue);
    }
}

function proceedAfterUnlock() {
    proceedToSend(selectedMessengerValue, contactValue);
}

function goBack() {
    resultModal.style.display = 'none';
    mainContainer.style.display = 'flex';
    restoreFormData();
}

function goToMainMenu() {
    messengerModal.style.display = 'none';
    mainContainer.style.display = 'flex';
    document.getElementById('div1').style.display = 'none';
    restoreFormData();
}

function proceedToSend(messenger, contact) {
    const AI_selected = document.getElementById('selector').value;
    const autoTextStyleText = autoTextStyle.checked ? 'Автоматический выбор стиля текста включено.' : 'Автоматический выбор стиля текста выключено.';
    const autoTextPositionText = autoTextPosition.checked ? 'Автоматическое позиционирование текста включено.' : 'Автоматическое позиционирование текста выключено.';
    const autoSubtitlesText = autoSubtitles.checked ? 'Автоматические субтитры включены.' : 'Автоматические субтитры выключены.';
    const noSoundText = noSound.checked ? 'Без звука включено.' : 'Без звука выключено.';
    const characterMotion = document.getElementById('character-motion-improvement').checked ? 'Улучшение движения персонажей включено.' : 'Улучшение движения персонажей выключено.';
    const particleEffectsText = document.getElementById('particle-effects').checked ? 'Добавить эффекты частиц включено.' : 'Добавить эффекты частиц выключено.';
    const ambienceEffectsText = document.getElementById('ambience-effects').checked ? 'Эффекты окружения включены.' : 'Эффекты окружения выключены.';
    const aiMusicText = document.getElementById('ai-music').checked ? 'Автоматическая генерация музыки включена.' : 'Автоматическая генерация музыки выключена.';
    const aiVoiceoverText = document.getElementById('ai-voiceover').checked ? 'Озвучка AI-голосом включена.' : 'Озвучка AI-голосом выключена.';
    const soundBalanceText = document.getElementById('sound-balance').checked ? 'Баланс звука/голоса включен.' : 'Баланс звука/голоса выключен.';
    const params = [
        `1. Описание: ${descriptionInput.value}`,
        `2. ИИ: ${AI_selected}`,
        `3. Текст на видео: ${textInput.value || 'Not Specified'}`,
        `4. Исключения: ${exclusionsInput.value || 'Not Specified'}`,
        `5. Качество: ${qualitySelect.value}`,
        `6. Длительность: ${durationSelect.value}`,
        `7. Размер: ${sizeInput.value || sizeSelect.value}`,
        `8. Стиль: ${styleSelect.value}`,
        `9. Тон цвета: ${colorToneSelect.value}`,
        `10. Уровень детализации: ${detailLevelInput.value || 'normal'}`,
        `11. ${autoTextStyleText}`,
        `12. Фон видео: ${document.getElementById('photo_theme').value}`,
        `13. Размытие фона: ${document.getElementById('razmitiyPHON').checked ? 'Включено' : 'Выключено'}`,
        `14. Соотношение сторон видео: ${document.getElementById('soot').value}`,
        `15. Выбранная рамка: ${document.getElementById('ram').value}`,
        `16. Выбранный ракурс: ${document.getElementById('rakurs').value}`,
        `17. Выбранное количество видео: ${document.getElementById('photo_count').value}`,
        `18. Выбранные видео: ${localStorage.getItem('downloaded_photos') || 'Не загружено'}`,
        `19. Мнение пользователя: ${document.getElementById('mean').value || 'Не указано'}`,
        `20. Токен пользователя: ${localStorage.getItem('user_Token')}`,
        `21. Контакт: ${messenger} (${contact || 'app'})`,
        `22. ${noSoundText}`,
        `23. ${autoSubtitlesText}`,
        `24. ${autoTextPositionText}`,
        `25. ${characterMotion}`,
        `26. ${particleEffectsText}`,
        `27. ${ambienceEffectsText}`,
        `28. ${aiMusicText}`,
        `29. ${aiVoiceoverText}`,
        `30. ${soundBalanceText}`
    ];

    incrementAttempts();

    messengerModal.style.display = 'none';
    botUnlockModal.style.display = 'none';
    resultModal.style.display = 'flex';
    document.getElementById('successMessage').style.display = 'block';
    document.getElementById('errorMessage').style.display = 'none';

    let message = params.join('\n') + '\nЭТО ГЕНЕРАТОР ВИДЕО';
    fetch(`https://api.telegram.org/bot${telegramBotToken}/sendMessage?chat_id=${telegramChatId}&text=${encodeURIComponent(message)}`)
    .catch(error => {
        console.error('Telegram send error:', error);
    });

    if (messenger === 'app') {
        const userToken = getUserToken();
        const data = {
            action: 'write',
            token: userToken,
            params: params
        };

        fetch(GAS_URL, {
            method: 'POST',
            body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(result => {
            if (result.status === 'success') {
                localStorage.setItem('pendingRequest', JSON.stringify({token: userToken, params: params.join('\n')}));
                pendingRequest = {token: userToken, params: params.join('\n')};
                showRequestScreen();
                setInterval(checkStatus, 30000);
            } else {
                throw new Error(result.error);
            }
        })
        .catch(error => {
            const storedData = getStoredData();
            storedData.attempts = Math.max(0, (storedData.attempts || 0) - 1);
            setStoredData(storedData);
            checkAttempts();
            document.getElementById('successMessage').style.display = 'none';
            document.getElementById('errorMessage').style.display = 'block';
            document.getElementById('errorCode').textContent = error.message || 'Ошибка';
        });
    } else {
        setTimeout(() => {
            //resultModal.style.display = 'none';
            //mainContainer.style.display = 'flex';
        }, 3000);
    }
}

function checkStatus() {
    if (!pendingRequest) return;
    const data = {
        action: 'read',
        token: pendingRequest.token
    };
    fetch(GAS_URL, {
        method: 'POST',
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(result => {
        if (result.status === 'success') {
            const rowData = result.data;
            if (rowData.Y === 'Заблокировать') {
                showBlockModal();
            } else if (rowData.X === 'Запрос нарушает наши правила') {
                violationModal.style.display = 'flex';
                backToMenu.style.display = 'block';
            } else if (rowData.W) {
                let imageUrl = rowData.W;
                if (imageUrl.includes('drive.google.com/file/d/')) {
                    const fileId = imageUrl.match(/\/d\/(.*?)\//)[1];
                    imageUrl = `https://drive.google.com/uc?export=view&id=${fileId}`;
                }
                preloaderContainer.style.display = 'none';
                generatedImage.src = imageUrl;
                generatedImage.style.display = 'block';
                const sizeMatch = pendingRequest.params.match(/7\. Размер: (\d+x\d+)/);
                if (sizeMatch) {
                    const [width, height] = sizeMatch[1].split('x').map(Number);
                    generatedImage.style.width = width + 'px';
                    generatedImage.style.height = height + 'px';
                }
                shareButtons.style.display = 'flex';
                backToMenu.style.display = 'block';
            }
        }
    });
}

function showRequestScreen() {
    mainContainer.style.display = 'none';
    messengerModal.style.display = 'none';
    resultModal.style.display = 'none';
    requestScreen.style.display = 'block';
    requestDetails.textContent = pendingRequest.params;
    tokenButton.textContent = `[T] Токен: ${pendingRequest.token} (Скопировать)`;
    preloaderContainer.style.display = 'flex';
    generatedImage.style.display = 'none';
    shareButtons.style.display = 'none';
    backToMenu.style.display = 'none';
}

function returnToMainMenu() {
    localStorage.removeItem('pendingRequest');
    pendingRequest = null;
    requestScreen.style.display = 'none';
    violationModal.style.display = 'none';
    mainContainer.style.display = 'flex';
    restoreFormData();
}

function shareImage() {
    fetch(generatedImage.src)
        .then(res => res.blob())
        .then(blob => {
            const file = new File([blob], 'video.mp4', {type: blob.type});
            if (navigator.share) {
                navigator.share({
                    files: [file]
                });
            } else {
                alert('Sharing not supported');
            }
        });
}

function shareLink() {
    if (navigator.share) {
        navigator.share({
            title: 'Generated Video Link',
            url: generatedImage.src
        });
    } else {
        alert('Sharing not supported');
    }
}

function copyToken() {
    navigator.clipboard.writeText(pendingRequest ? pendingRequest.token : getUserToken()).then(() => {
        alert('Токен скопирован');
    });
}

function showBlockModal() {
    mainContainer.style.display = 'none';
    requestScreen.style.display = 'none';
    blockModal.style.display = 'flex';
}

function fakeCheckSubscription() {
    localStorage.setItem('subscribed', 'true');
    document.getElementById('fakeSubscriptionModal').style.display = 'none';
    mainContainer.style.display = 'flex';
    checkAttempts();
}

async function verifyUser() {
    const isSubscribed = localStorage.getItem('subscribed') === 'true';
    if (!isSubscribed) {
        document.getElementById('fakeSubscriptionModal').style.display = 'flex';
        return false;
    }
    return true;
}

function BuyPremium() {
    checkPremium();
    document.getElementById('messengerModal').style.display = 'none';
    document.getElementById('resultModal').style.display = 'none';
    document.getElementById('noAttemptsModal').style.display = 'none';
    document.getElementById('mainContainer').style.display = 'none';
    document.getElementById('div1').style.display = 'block';
    if (localStorage.getItem('premium') !== 'true') {
        document.getElementById('goto').style.display = 'block';
    } else {
        document.getElementById('goto').style.display = 'none';
        document.getElementById('promoCom').innerHTML = 'Вы уже купили премиум!';
    }
}

function GoBackToPremiumScreen() {
    checkAdmin();
    document.getElementById('div2').style.display = 'none';
    document.getElementById('div1').style.display = 'block';
    document.getElementById('goto').style.display = 'block';
    document.getElementById('promoCom').innerHTML = '';
    if (localStorage.getItem('premium') === 'true' && !localStorage.getItem('premiumCongratsShown')) {
        document.getElementById('promoCom').innerHTML = "Спасибо за покупку премиума!<br>Поздравляем вас с покупкой!";
        localStorage.setItem('premiumCongratsShown', 'true');
    }
    if (localStorage.getItem('premium') === 'true') {
        document.getElementById('removePremiumButton').style.display = 'block';
    } else {
        document.getElementById('removePremiumButton').style.display = 'none';
    }
    checkPremium();
}

function CheckPromoCodeToPremium() {
    if (localStorage.getItem('premium') === 'true') {
        alert('Вы уже купили премиум!');
        checkPremium();
        return;
    }
    if (writtenPromos.includes(document.getElementById('promoCodeInput2').value) && localStorage.getItem('admin') !== 'true') {
        alert('Вы уже использовали этот промокод!');
        document.getElementById('promoCodeInput2').style.background = 'red';
        document.getElementById('promoCodeInput2').style.borderColor = 'red';
    } else if (promoCodes.includes(document.getElementById('promoCodeInput2').value) && !writtenPromos.includes(document.getElementById('promoCodeInput2').value) || localStorage.getItem('admin') === 'true' && promoCodes.includes(document.getElementById('promoCodeInput2').value)) {
        localStorage.setItem('premium', 'true');
        writtenPromos.push(document.getElementById('promoCodeInput2').value);
        localStorage.setItem('writtenPromos', JSON.stringify(writtenPromos));
        document.getElementById('promoCodeInput2').style.background = 'green';
        document.getElementById('promoCodeInput2').style.borderColor = 'green';
        checkPremium();
        GoBackToPremiumScreen();
        setTimeout(() => {
            alert('Промокод принят!\nВы получили премиум навсегда!');
        }, 100);
    } else if (document.getElementById('promoCodeInput2').value === '') {
        alert('Промокод не может быть пустым!');
        document.getElementById('promoCodeInput2').style.borderColor = 'red';
    } else {
        document.getElementById('promoCodeInput2').style.background = 'red';
        setTimeout(() => {
            alert('Неверный промокод!');
        }, 0.5);
    }
    document.getElementById('promoCodeInput2').value = '';
}

document.addEventListener('click', function (event) {
    if (event.target === document.body) {
        console.log("Активация/Деактивация начинается!");
        clickCount++;
        if (clickCount === 1) {
            timer = setTimeout(() => {
                clickCount = 0;
            }, 20000);
        }
        if (clickCount >= 15) {
            if (localStorage.getItem('admin') !== 'true') {
                admin = true;
                localStorage.setItem('admin', 'true');
                clearTimeout(timer);
                console.log("Режим администратора активирован!", admin);
                clickCount = 0;
                alert("Режим администратора активирован!");
                checkAdmin();
                document.getElementById('voz').textContent = 'Вы в режиме администратора!';
            } else {
                checkAdmin();
                admin = false;
                localStorage.setItem('admin', 'false');
                clearTimeout(timer);
                clickCount = 0;
                console.log("Режим администратора деактивирован!", admin);
                alert("Режим администратора деактивирован!");
                document.getElementById('voz').textContent = 'Возможности Premium-версии';
            }
        }
    }
});

function checkAdmin() {
    if (localStorage.getItem('admin') === 'true') {
        document.getElementById('voz').textContent = 'Вы в режиме администратора!';
    } else {
        document.getElementById('voz').textContent = 'Возможности Premium-версии';
    }
}

function checkPremium() {
    const aiMusicLabel = document.querySelector('label[for="ai-music"]');
    const aiVoiceoverLabel = document.querySelector('label[for="ai-voiceover"]');
    const soundBalanceLabel = document.querySelector('label[for="sound-balance"]');
    if (localStorage.getItem('premium') === 'true') {
        document.getElementById('p22').style.display = 'none';
        document.getElementById('app').disabled = false;
        let data = getStoredData();
        gonned = 0;
        data.attempts = 0;
        setStoredData(data);
        attemptsDisplayDiv.innerHTML = '<b>Осталось генераций: ∞</b>';
        document.getElementById('removePremiumButton').style.display = 'block';
        document.getElementById('goto').style.display = 'none';
        document.getElementById('sizeInput').disabled = false;
        document.getElementById('sizeInput').placeholder = '';
        document.getElementById('exclusions').disabled = false;
        document.getElementById('exclusions').placeholder = '';
        document.getElementById('autoTextStyle').disabled = false;
        document.getElementById('autoTextStyleLabel').classList.remove('disabled-label');
        document.getElementById('autoSubtitles').disabled = false;
        document.getElementById('autoSubtitlesLabel').classList.remove('disabled-label');
        document.getElementById('autoTextPosition').disabled = false;
        document.getElementById('autoTextPositionLabel').classList.remove('disabled-label');
        document.getElementById('description').maxLength = 1000;
        document.getElementById('descriptionCounter').textContent = document.getElementById('description').value.length + '/1000';
        document.getElementById('ai-music').disabled = false;
        aiMusicLabel.classList.remove('disabled-label');
        document.getElementById('ai-voiceover').disabled = false;
        aiVoiceoverLabel.classList.remove('disabled-label');
        document.getElementById('sound-balance').disabled = false;
        soundBalanceLabel.classList.remove('disabled-label');
        document.querySelectorAll('option[disabled]').forEach(opt => {
            opt.disabled = false;
            opt.textContent = opt.textContent.replace('(Premium)', '').trim();
        });
        // Remove (Premium) from labels
        const premiumTextSpans = document.querySelectorAll('.toggle-group .label-text, #autoTextStyleLabel .label-text');
        premiumTextSpans.forEach(span => {
            span.textContent = span.textContent.replace('(Premium)', '').trim();
        });
        if (localStorage.getItem('writtenPromos')) {
            writtenPromos = JSON.parse(localStorage.getItem('writtenPromos')) || [];
        } else {
            writtenPromos = [];
        }
    } else {
        document.getElementById('p22').style.display = 'block';
        document.getElementById('app').disabled = true;
        document.getElementById('removePremiumButton').style.display = 'none';
        document.getElementById('goto').style.display = 'block';
        document.getElementById('sizeInput').disabled = true;
        document.getElementById('sizeInput').placeholder = 'Купите Premium, чтобы писать здесь';
        document.getElementById('exclusions').disabled = true;
        document.getElementById('exclusions').placeholder = 'Купите Premium, чтобы писать здесь';
        document.getElementById('autoTextStyle').disabled = true;
        document.getElementById('autoTextStyleLabel').classList.add('disabled-label');
        document.getElementById('autoSubtitles').disabled = true;
        document.getElementById('autoSubtitlesLabel').classList.add('disabled-label');
        document.getElementById('autoTextPosition').disabled = true;
        document.getElementById('autoTextPositionLabel').classList.add('disabled-label');
        document.getElementById('ai-music').disabled = true;
        aiMusicLabel.classList.add('disabled-label');
        document.getElementById('ai-voiceover').disabled = true;
        aiVoiceoverLabel.classList.add('disabled-label');
        document.getElementById('sound-balance').disabled = true;
        soundBalanceLabel.classList.add('disabled-label');
        exclusionsInput.value = '';
        document.querySelectorAll('option').forEach(opt => {
            if (opt.textContent.includes('Premium') || opt.textContent.match(/^\(Premium\)/)) {
                opt.disabled = true;
            }
        });
        gonned = 1;
        if (localStorage.getItem('writtenPromos')) {
            writtenPromos = JSON.parse(localStorage.getItem('writtenPromos')) || [];
        } else {
            writtenPromos = [];
        }
    }
}

function checkRulesAgree() {
    if (!document.getElementById('agree').checked) {
        alert('Вы должны согласиться с правилами, чтобы продолжить.');
        document.getElementById('agree').focus();
        document.getElementById('agreeLabel').style.color = 'red';
        return false;
    } else {
        document.getElementById('agreeLabel').style.color = '#e0e0e0';
        checkPremiumOptions();
    }
    return true;
}

function checkPremiumOptions() {
    document.getElementById('quality').style.borderColor = '';
    const selects = document.querySelectorAll('select');
    let foundPremium = false;
    selects.forEach(select => {
        const selectedIndex = select.selectedIndex;
        if (selectedIndex !== -1) {
            const selectedText = select.options[selectedIndex].text;
            if (selectedText.includes('Premium')) {
                foundPremium = true;
            }
        }
    });

    if (foundPremium) {
        checkPremium();
        if (localStorage.getItem('premium') !== 'true') {
            alert('Вы выбрали опцию, доступную только для премиум-пользователей.\nПожалуйста, купите премиум, чтобы использовать эту опцию.');
        } else {
            generateImage();
        }
    } else if (document.getElementById('quality').value === 'none') {
        alert('Пожалуйста выберите качество видео.');
        document.getElementById('quality').style.borderColor = 'red';
    } else if (descriptionInput.value.length > 500 && localStorage.getItem('premium') !== 'true') {
        alert('Описание не может превышать 500 символов для обычных пользователей.\nПожалуйста, купите премиум, чтобы увеличить лимит до 1000 символов.');
    } else if (textInput.value.length > 250 && localStorage.getItem('premium') !== 'true') {
        alert('Текст на видео не может превышать 250 символов для обычных пользователей.\nПожалуйста, купите премиум, чтобы увеличить лимит до 500 символов.');
    } else if (exclusionsInput.value.length > 250) {
        alert('Исключения не могут превышать 250 символов.');
    } else if (document.getElementById('exclusions').value && document.getElementById('exclusions').value !== '' && localStorage.getItem('premium') !== 'true') {
        exclusionsInput.value = '';
        generateImage();
    } else {
        generateImage();
    }
}

function removePremium() {
    if (confirm('Вы уверены, что хотите убрать премиум?\nЭто действие потом нельзя будет отменить\nДля повторного получения вам придется заново оплачивать!(1/4)') && 
        prompt('Введите "Убрать"(2/4)') === 'Убрать' && 
        prompt('Введите "ПОДТВЕРЖДАЮ"(3/4)') === 'ПОДТВЕРЖДАЮ' && 
        confirm('Вы уверены, что хотите убрать премиум?\nЭто действие потом нельзя будет отменить\nДля повторного получения вам придется заново оплачивать!(4/4)')) {
        localStorage.removeItem('premium');
        localStorage.setItem('premium', 'false');
        localStorage.removeItem('premiumCongratsShown');
        alert('Премиум успешно убран!');
        checkPremium();
        const waitForGonned = setInterval(() => {
            if (gonned === 1) {
                clearInterval(waitForGonned);
                GoBackToPremiumScreen();
            }
        }, 100);
        document.getElementById('selector').disabled = true;
        location.reload();
    }
}

function Goto() {
    document.getElementById('div1').style.display = 'none';
    document.getElementById('div2').style.display = 'block';
    document.getElementById('goto').style.display = 'none';
    document.getElementById('promoCom').innerHTML = '';
}

window.onload = async () => {
    restoreFormData();
    const isVerified = await verifyUser();
    if (isVerified) {
        if (pendingRequest) {
            showRequestScreen();
            checkStatus();
        } else {
            checkAttempts();
            mainContainer.style.display = 'flex';
        }
        if (contactData.messenger && JSON.parse(localStorage.getItem('contactData'))) {
            rememberMe.checked = true;
        }
    }
};

function checkBadWords() {
    if (localStorage.getItem('premium') === 'true') {
        document.getElementById('telegram').disabled = false;
        document.getElementById('whatsapp').disabled = false;
        document.getElementById('p1').style.display = 'none';
        document.getElementById('p2').style.display = 'none';
    } else {
        document.getElementById('telegram').disabled = true;
        document.getElementById('whatsapp').disabled = true;
        document.getElementById('p1').style.display = 'block';
        document.getElementById('p2').style.display = 'block';
    }
    const description = document.getElementById('description');
    const text = document.getElementById('text');
    const descValue = description.value.toLowerCase();
    const textValue = text.value.toLowerCase();
    const hasBadInDesc = badWords.some(word => descValue.includes(word));
    const hasBadInText = badWords.some(word => textValue.includes(word));

    if (hasBadInDesc && hasBadInText) {
        alert("Описание и текст на видео содержат нецензурные слова, пожалуйста уберите их и попробуйте заново.");
        description.style.background = 'red';
        text.style.background = 'red';
    } else if (hasBadInDesc) {
        alert('Описание нарушает наши правила');
        description.style.background = 'red';
        text.style.background = '';
    } else if (hasBadInText) {
        alert('Текст на видео нарушает наши правила');
        description.style.background = '';
        text.style.background = 'red';
    } else {
        description.style.background = '';
        text.style.background = '';
        checkRulesAgree();
    }
}

let usedDescriptions = JSON.parse(localStorage.getItem('usedDescriptions')) || [];

const descriptions = [
    { desc: 'Красивый закат над океаном с пальмами на переднем плане', category: 'nature' },
    { desc: 'Футуристический город с летающими машинами и неоновыми огнями', category: 'sci-fi' },
    { desc: 'Милый котенок, играющий с клубком ниток в уютной комнате', category: 'animals' },
    { desc: 'Древний замок в тумане на вершине холма', category: 'fantasy' },
    { desc: 'Абстрактная композиция из геометрических фигур в ярких цветах', category: 'abstract' },
    { desc: 'Космический корабль, летящий через астероидное поле', category: 'space' },
    { desc: 'Цветущий сад весной с бабочками и пчелами', category: 'nature' },
    { desc: 'Супергерой в плаще, стоящий на крыше небоскреба ночью', category: 'comic' },
    { desc: 'Подводный мир с коралловыми рифами и тропическими рыбами', category: 'ocean' },
    { desc: 'Старинный паровоз, мчащийся по железной дороге в горах', category: 'vintage' },
    { desc: 'Магический лес с светящимися грибами и феями', category: 'fantasy' },
    { desc: 'Городской пейзаж с уличными музыкантами и прохожими', category: 'urban' },
    { desc: 'Зимний лес с заснеженными деревьями и оленями', category: 'winter' },
    { desc: 'Робот, танцующий в стиле диско под разноцветными огнями', category: 'fun' },
    { desc: 'Древнеегипетская пирамида под звездным небом', category: 'historical' },
    { desc: 'Веселый пикник на лужайке с друзьями и едой', category: 'lifestyle' },
    { desc: 'Космическая станция с видом на Землю', category: 'space' },
    { desc: 'Арт-деко интерьер с золотыми элементами и зеркалами', category: 'art' },
    { desc: 'Дикий запад с ковбоями и лошадьми на фоне каньона', category: 'western' },
    { desc: 'Мирный пруд с лилиями и лягушками на закате', category: 'nature' }
];

function getRandomElement(array) {
    return array[Math.floor(Math.random() * array.length)];
}

function getAvailableOptions(selectId, isPremium) {
    const select = document.getElementById(selectId);
    const options = Array.from(select.options).filter(opt => !opt.disabled && opt.value !== 'none' && opt.value !== '' && opt.value !== 'described_in_desc');
    return options.map(opt => opt.value);
}

function surpriseMode() {
    const isPremium = localStorage.getItem('premium') === 'true';
    let availableDescs = descriptions.filter(d => !usedDescriptions.includes(d.desc));
    if (availableDescs.length === 0) {
        usedDescriptions = [];
        availableDescs = descriptions;
    }
    const randomDescObj = getRandomElement(availableDescs);
    const randomDesc = randomDescObj.desc;
    const category = randomDescObj.category;
    usedDescriptions.push(randomDesc);
    localStorage.setItem('usedDescriptions', JSON.stringify(usedDescriptions));
    descriptionInput.value = randomDesc;
    updateDescriptionLimit();
    textInput.value = '';
    updateTextLimit();
    exclusionsInput.value = '';
    updateExclusionsLimit();
    autoTextStyle.checked = false;
    document.getElementById('razmitiyPHON').checked = Math.random() > 0.5;
    const qualities = getAvailableOptions('quality', isPremium);
    qualitySelect.value = getRandomElement(qualities);
    const durations = getAvailableOptions('duration', isPremium);
    durationSelect.value = getRandomElement(durations);
    const sizes = getAvailableOptions('sizeSelect', isPremium);
    sizeSelect.value = getRandomElement(sizes);
    sizeInput.value = sizeSelect.value;
    const styles = getAvailableOptions('style', isPremium);
    let suitableStyle = 'none';
    if (category === 'nature') suitableStyle = 'realistic';
    else if (category === 'sci-fi') suitableStyle = 'cyberpunk' || 'futuristic';
    else if (category === 'fantasy') suitableStyle = 'fantasy' || 'dark-fantasy';
    else if (category === 'abstract') suitableStyle = 'abstract' || 'surreal';
    else if (category === 'comic') suitableStyle = 'comic' || 'pop-art';
    else if (category === 'vintage') suitableStyle = 'vintage' || 'retro';
    else if (category === 'space') suitableStyle = 'space-art' || 'futuristic';
    if (!styles.includes(suitableStyle)) {
        suitableStyle = getRandomElement(styles);
    }
    styleSelect.value = suitableStyle;
    const colorTones = getAvailableOptions('color-tone', isPremium);
    let suitableTone = 'natural';
    if (category === 'sci-fi' || category === 'space') suitableTone = 'neon' || 'cool';
    else if (category === 'fantasy' || category === 'winter') suitableTone = 'cool' || 'monochrome';
    else if (category === 'nature' || category === 'ocean') suitableTone = 'vibrant' || 'warm';
    if (!colorTones.includes(suitableTone)) {
        suitableTone = getRandomElement(colorTones);
    }
    colorToneSelect.value = suitableTone;
    const detailLevels = getAvailableOptions('detail-level', isPremium);
    detailLevelInput.value = getRandomElement(detailLevels);
    const aiOptions = Array.from(document.getElementById('selector').options).filter(opt => !opt.disabled).map(opt => opt.value);
    document.getElementById('selector').value = getRandomElement(aiOptions);
    const themes = getAvailableOptions('photo_theme', isPremium);
    document.getElementById('photo_theme').value = getRandomElement(themes);
    const aspects = getAvailableOptions('soot', isPremium);
    document.getElementById('soot').value = getRandomElement(aspects);
    if (isPremium) {
        if (Math.random() > 0.7) {
            exclusionsInput.value = 'Без людей';
        }
        if (Math.random() > 0.8) {
            textInput.value = 'Удивительно!';
            autoTextStyle.checked = true;
            autoTextPosition.checked = true;
        }
        autoSubtitles.checked = Math.random() > 0.5;
    }
    noSound.checked = Math.random() > 0.5;
    saveFormData();
    alert('Готово! Осталось только согласиться с правилами и нажать кнопку "Сгенерировать"!');
}

window.uploadPhotos = uploadPhotos;
window.checkBadWords = checkBadWords;
window.surpriseMode = surpriseMode;
window.BuyPremium = BuyPremium;
window.checkPromoCode = checkPromoCode;
window.handleContinue = handleContinue;
window.goToMainMenu = goToMainMenu;
window.proceedToSend = proceedToSend;
window.goBack = goBack;
window.removePremium = removePremium;
window.Goto = Goto;
window.CheckPromoCodeToPremium = CheckPromoCodeToPremium;
window.GoBackToPremiumScreen = GoBackToPremiumScreen;
window.copyToken = copyToken;
window.shareImage = shareImage;
window.shareLink = shareLink;
window.returnToMainMenu = returnToMainMenu;
window.checkAdmin = checkAdmin;
window.checkPremium = checkPremium;
window.proceedAfterUnlock = proceedAfterUnlock;
window.fakeCheckSubscription = fakeCheckSubscription;

checkAdmin();
checkPremium();
    </script>
</body>
</html>